import os
import asyncio
import traceback
import logging
import re
import signal
import sys
from datetime import datetime
from aiogram import Bot, Dispatcher, types, F
from aiogram.filters import Command
from aiogram.fsm.context import FSMContext
from aiogram.fsm.state import State, StatesGroup
from aiogram.fsm.storage.memory import MemoryStorage
from aiogram.utils.keyboard import InlineKeyboardBuilder
from aiohttp import web, ClientSession

# –î–ª—è Render.com: –æ—Ç–∫–ª—é—á–∞–µ–º –æ–±—Ä–∞–±–æ—Ç–∫—É —Å–∏–≥–Ω–∞–ª–æ–≤, –∫–æ—Ç–æ—Ä—ã–µ –≤—ã–∑—ã–≤–∞—é—Ç –ø—Ä–æ–±–ª–µ–º—ã
signal.signal(signal.SIGALRM, signal.SIG_IGN)
signal.signal(signal.SIGCHLD, signal.SIG_IGN)

# –ù–∞—Å—Ç—Ä–æ–π–∫–∞ asyncio –¥–ª—è Render.com
if sys.platform != 'win32':
    try:
        import uvloop
        asyncio.set_event_loop_policy(uvloop.EventLoopPolicy())
    except ImportError:
        pass

# –ò–º–ø–æ—Ä—Ç Cerebras —Å –æ–±—Ä–∞–±–æ—Ç–∫–æ–π –æ—à–∏–±–æ–∫
try:
    from cerebras.cloud.sdk import AsyncCerebras
    CEREBRAS_AVAILABLE = True
except ImportError:
    CEREBRAS_AVAILABLE = False

# --- –ö–û–ù–§–ò–ì–£–†–ê–¶–ò–Ø ---
–¢–û–ö–ï–ù_–ë–û–¢–ê = os.getenv("BOT_TOKEN")
–ö–õ–Æ–ß_API = os.getenv("AI_API_KEY")
–ò–î_–ö–ê–ù–ê–õ–ê = "@metaformula_life"
–ò–î_–ê–î–ú–ò–ù–ê = 7830322013

# –†–µ—Å—É—Ä—Å—ã –ø—Ä–æ–µ–∫—Ç–∞
–°–°–´–õ–ö–ê_–õ–û–ì–û_–§–û–†–ú–£–õ–ê = "https://raw.githubusercontent.com/Elektra174/meta_navigator_bot/main/logo.png"
–°–°–´–õ–ö–ê_–õ–û–ì–û_–ù–ê–í–ò–ì–ê–¢–û–† = "https://raw.githubusercontent.com/Elektra174/meta_navigator_bot/main/logo11.png"
–°–°–´–õ–ö–ê_–ü–†–û–¢–û–ö–û–õ–ê = "https://raw.githubusercontent.com/Elektra174/meta_navigator_bot-TEST/main/avtopilot.pdf"
–ò–ú–Ø_–§–ê–ô–õ–ê_–ü–†–û–¢–û–ö–û–õ–ê = "–î–ï–®–ò–§–†–û–í–ö–ê_–ê–í–¢–û–ü–ò–õ–û–¢–ê.pdf"
–°–°–´–õ–ö–ê_–ú–ê–°–¢–ï–†–ö–õ–ê–°–°–ê = "https://youtube.com/playlist?list=PLyour_playlist_id"
–°–°–´–õ–ö–ê_–ö–ê–ù–ê–õ–ê = "https://t.me/metaformula_life"

# –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è
logging.basicConfig(
    level=logging.INFO,
    format='%(asctime)s - %(name)s - %(levelname)s - %(message)s',
    handlers=[
        logging.StreamHandler(sys.stdout)
    ]
)
–ª–æ–≥–≥–µ—Ä = logging.getLogger(__name__)

# –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –∫–ª–∏–µ–Ω—Ç–æ–≤
–±–æ—Ç = Bot(token=–¢–û–ö–ï–ù_–ë–û–¢–ê)
–¥–∏—Å–ø–µ—Ç—á–µ—Ä = Dispatcher(storage=MemoryStorage())

# –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è Cerebras —Ç–æ–ª—å–∫–æ –µ—Å–ª–∏ –µ—Å—Ç—å –∫–ª—é—á –∏ SDK –¥–æ—Å—Ç—É–ø–µ–Ω
–∫–ª–∏–µ–Ω—Ç = None
if –ö–õ–Æ–ß_API and CEREBRAS_AVAILABLE:
    try:
        –∫–ª–∏–µ–Ω—Ç = AsyncCerebras(api_key=–ö–õ–Æ–ß_API)
        –ª–æ–≥–≥–µ—Ä.info("Cerebras –∫–ª–∏–µ–Ω—Ç –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω")
    except Exception as e:
        –ª–æ–≥–≥–µ—Ä.error(f"–û—à–∏–±–∫–∞ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏–∏ Cerebras: {e}")
        –∫–ª–∏–µ–Ω—Ç = None
else:
    –ª–æ–≥–≥–µ—Ä.warning("Cerebras API –Ω–µ–¥–æ—Å—Ç—É–ø–µ–Ω, –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –¥–µ–º–æ-—Ä–µ–∂–∏–º")

# –ì–ª–æ–±–∞–ª—å–Ω—ã–µ —Å—á–µ—Ç—á–∏–∫–∏ —Ç–µ–ª–µ–º–µ—Ç—Ä–∏–∏
—Å—á–µ—Ç—á–∏–∫_–æ—à–∏–±–æ–∫ = 0
—Å–±–æ–∏_api = 0
–≤—Ä–µ–º—è_—Å—Ç–∞—Ä—Ç–∞ = datetime.now()

class –°–æ—Å—Ç–æ—è–Ω–∏–µ–ê—É–¥–∏—Ç–∞(StatesGroup):
    –æ—Ç–≤–µ—Ç—ã_–Ω–∞_–≤–æ–ø—Ä–æ—Å—ã = State()

# --- –°–ü–ò–°–û–ö –í–û–ü–†–û–°–û–í –î–ò–ê–ì–ù–û–°–¢–ò–ö–ò –ë–ò–û–õ–û–ì–ò–ß–ï–°–ö–û–ì–û –ö–û–ù–¢–£–†–ê ---
–í–û–ü–†–û–°–´ = [
    # –í–æ–ø—Ä–æ—Å 1: –õ–æ–∫–∞—Ü–∏—è —Å–∏—Å—Ç–µ–º–Ω–æ–π –æ—à–∏–±–∫–∏
    "–õ–æ–∫–∞—Ü–∏—è —Å–∏—Å—Ç–µ–º–Ω–æ–π –æ—à–∏–±–∫–∏: ¬´–í –∫–∞–∫–æ–π –æ–±–ª–∞—Å—Ç–∏ –≤–∞—à–µ–π –∂–∏–∑–Ω–∏ –Ω–µ–π—Ä–æ–Ω–Ω–∞—è —Å–µ—Ç—å —Å–µ–π—á–∞—Å –≤—ã–¥–∞–µ—Ç –∫—Ä–∏—Ç–∏—á–µ—Å–∫—É—é –æ—à–∏–±–∫—É –∏ \"–±—É–∫—Å—É–µ—Ç\" –Ω–∞ –º–µ—Å—Ç–µ? –û–ø–∏—à–∏—Ç–µ —Å–∏—Ç—É–∞—Ü–∏—é, –≥–¥–µ –≤—ã —á—É–≤—Å—Ç–≤—É–µ—Ç–µ –±–µ–≥ –ø–æ –∫—Ä—É–≥—É¬ª.",
    # –í–æ–ø—Ä–æ—Å 2: –°–ø–µ—Ü–∏—Ñ–∏–∫–∞—Ü–∏–∏ –ú–µ—Ç–∞-–º–∞—è–∫–∞
    "–°–ø–µ—Ü–∏—Ñ–∏–∫–∞—Ü–∏–∏ –ú–µ—Ç–∞-–º–∞—è–∫–∞: ¬´–ü—Ä–µ–¥—Å—Ç–∞–≤—å—Ç–µ, —á—Ç–æ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –≤–∞—à–µ–π –ø—Ä–æ—à–∏–≤–∫–∏ –æ–±–Ω–æ–≤–∏–ª–∏—Å—å –∏ –∑–∞—Ç—ã–∫ –∏—Å—á–µ–∑. –ö–∞–∫–∏–º —Å—Ç–∞–Ω–µ—Ç –≤–∞—à–µ –µ—Å—Ç–µ—Å—Ç–≤–µ–Ω–Ω–æ–µ —ç—Ç–∞–ª–æ–Ω–Ω–æ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ? –û–ø–∏—à–∏—Ç–µ –æ—â—É—â–µ–Ω–∏–µ —Å–µ–±—è (–Ω–∞–ø—Ä–∏–º–µ—Ä: –Ø—Å–Ω–æ—Å—Ç—å, –ú–æ—â–Ω–æ—Å—Ç—å, –°–≤–æ–±–æ–¥–∞)¬ª.",
    # –í–æ–ø—Ä–æ—Å 3: –•–æ–ª–æ—Å—Ç–æ–π —Ö–æ–¥ –ø—Ä–æ—Ü–µ—Å—Å–æ—Ä–∞ (–î–°–ú)
    "–•–æ–ª–æ—Å—Ç–æ–π —Ö–æ–¥ –ø—Ä–æ—Ü–µ—Å—Å–æ—Ä–∞ (–î–°–ú): ¬´–ù–∞ –∫–∞–∫–∏–µ —Ñ–æ–Ω–æ–≤—ã–µ –º—ã—Å–ª–∏, —Ç—Ä–µ–≤–æ–≥–∏ –∏–ª–∏ —Ä—É–º–∏–Ω–∞—Ü–∏–∏ (\"–º—ã—Å–ª–∏—Ç–µ–ª—å–Ω–æ–π –∂–≤–∞—á–∫–∏\") –≤–∞—à –º–æ–∑–≥ –±–µ—Å–ø–æ–ª–µ–∑–Ω–æ —Å–ª–∏–≤–∞–µ—Ç –¥–æ 80% —ç–Ω–µ—Ä–≥–∏–∏ –∫–∞–∂–¥—ã–π –¥–µ–Ω—å?¬ª.",
    # –í–æ–ø—Ä–æ—Å 4: –û–±—Ä–∞–∑ –±–ª–æ–∫–∏—Ä—É—é—â–µ–≥–æ –∫–æ–Ω—Ç—É—Ä–∞
    "–û–±—Ä–∞–∑ –±–ª–æ–∫–∏—Ä—É—é—â–µ–≥–æ –∫–æ–Ω—Ç—É—Ä–∞: ¬´–ï—Å–ª–∏ –±—ã —ç—Ç–æ—Ç –∑–∞—Å—Ç–æ–π –±—ã–ª —Ñ–∏–∑–∏—á–µ—Å–∫–∏–º –æ–±—ä–µ–∫—Ç–æ–º, –∫–∞–∫ –±—ã –æ–Ω –≤—ã–≥–ª—è–¥–µ–ª –≤ –≤–∞—à–µ–º –≤–æ–æ–±—Ä–∞–∂–µ–Ω–∏–∏? (–ù–∞–ø—Ä–∏–º–µ—Ä: –±–µ—Ç–æ–Ω–Ω–∞—è –ø–ª–∏—Ç–∞, –≤—è–∑–∫–æ–µ –±–æ–ª–æ—Ç–æ)¬ª.",
    # –í–æ–ø—Ä–æ—Å 5: –ë–∏–æ–ª–æ–≥–∏—á–µ—Å–∫–∏–π –¥–∞—Ç—á–∏–∫ (–°–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π –º–∞—Ä–∫–µ—Ä)
    "–ë–∏–æ–ª–æ–≥–∏—á–µ—Å–∫–∏–π –¥–∞—Ç—á–∏–∫ (–°–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π –º–∞—Ä–∫–µ—Ä): ¬´–ì–¥–µ –≤ –≤–∞—à–µ–º —Ç–µ–ª–µ –Ω–∞—Ö–æ–¥–∏—Ç—Å—è –¥–∞—Ç—á–∏–∫ —ç—Ç–æ–≥–æ —Å–æ–ø—Ä–æ—Ç–∏–≤–ª–µ–Ω–∏—è? –û–ø–∏—à–∏—Ç–µ —Ñ–∏–∑–∏–∫—É –æ—â—É—â–µ–Ω–∏—è: —Å–∂–∞—Ç–∏–µ, —Ö–æ–ª–æ–¥, –≤—è–∑–∫–æ—Å—Ç—å?¬ª.",
    # –í–æ–ø—Ä–æ—Å 6: –°–∫–∞–Ω —Ç–µ–Ω–µ–≤–æ–≥–æ —Ä–µ—Å—É—Ä—Å–∞
    "–°–∫–∞–Ω —Ç–µ–Ω–µ–≤–æ–≥–æ —Ä–µ—Å—É—Ä—Å–∞: ¬´–ö–∞–∫–æ–µ –∫–∞—á–µ—Å—Ç–≤–æ –≤ –¥—Ä—É–≥–∏—Ö –ª—é–¥—è—Ö –≤—ã–∑—ã–≤–∞–µ—Ç —É –≤–∞—Å —Å–∏—Å—Ç–µ–º–Ω—ã–π —Å–±–æ–π (—Ä–∞–∑–¥—Ä–∞–∂–µ–Ω–∏–µ)? –í —ç—Ç–æ–º \"–±–∞–≥–µ\" –∑–∞–ø–µ—Ä—Ç–∞ –≤–∞—à–∞ —Å–∫—Ä—ã—Ç–∞—è —Å–∏–ª–∞¬ª.",
    # –í–æ–ø—Ä–æ—Å 7: –¶–µ–Ω–∞ –≥—Ä–∞–≤–∏—Ç–∞—Ü–∏–∏ —ç–Ω—Ç—Ä–æ–ø–∏–∏
    "–¶–µ–Ω–∞ –≥—Ä–∞–≤–∏—Ç–∞—Ü–∏–∏ —ç–Ω—Ç—Ä–æ–ø–∏–∏: ¬´–†–∞—Å—Å—á–∏—Ç–∞–π—Ç–µ —Ü–µ–Ω—É –±–µ–∑–¥–µ–π—Å—Ç–≤–∏—è: —Å–∫–æ–ª—å–∫–æ —Ä–µ—Å—É—Ä—Å–æ–≤ —Å–∏—Å—Ç–µ–º—ã (–≤—Ä–µ–º–µ–Ω–∏, –¥–µ–Ω–µ–≥, –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–µ–π) –≤—ã –ø–æ—Ç–µ—Ä—è–µ—Ç–µ –∑–∞ –≥–æ–¥, –ø–æ–∫–∞ —ç—Ç–æ—Ç –±–∞–≥ –∞–∫—Ç–∏–≤–µ–Ω?¬ª.",
    # –í–æ–ø—Ä–æ—Å 8: –ö–æ–º–∞–Ω–¥–∞ –Ω–∞ –ø–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∫—É
    "–ö–æ–º–∞–Ω–¥–∞ –Ω–∞ –ø–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∫—É: ¬´–í—ã –≥–æ—Ç–æ–≤—ã –∑–∞–Ω—è—Ç—å –º–µ—Å—Ç–æ –ê–≤—Ç–æ—Ä–∞ –≤ —Å–≤–æ–µ–π —Å–∏—Å—Ç–µ–º–µ –∏ –∑–∞–ø—É—Å—Ç–∏—Ç—å –ø—Ä–æ—Ç–æ–∫–æ–ª –ø–µ—Ä–µ–ø—Ä–æ—à–∏–≤–∫–∏ –Ω–∞—Å—Ç—Ä–æ–µ–∫?¬ª."
]

# --- –ü–†–ò–í–ï–¢–°–¢–í–ò–Ø ---
–ü–†–ò–í–ï–¢–°–¢–í–ò–Ø = {
    "–Ω–µ_–ø–æ–¥–ø–∏—Å–∞–Ω": {
        "–∑–∞–≥–æ–ª–æ–≤–æ–∫": "–î–æ–±—Ä–æ –ø–æ–∂–∞–ª–æ–≤–∞—Ç—å –≤ ¬´–ú–µ—Ç–∞—Ñ–æ—Ä–º—É–ª—É –ñ–∏–∑–Ω–∏¬ª",
        "—Ç–µ–∫—Å—Ç": "–ú–µ–Ω—è –∑–æ–≤—É—Ç –ê–ª–µ–∫—Å–∞–Ω–¥—Ä –õ–∞–∑–∞—Ä–µ–Ω–∫–æ. –Ø ‚Äî –∞–≤—Ç–æ—Ä –ø—Ä–æ–µ–∫—Ç–∞.\n\n"
                "–Ø —Å–æ–∑–¥–∞–ª –ú–µ—Ç–∞-–Ω–∞–≤–∏–≥–∞—Ç–æ—Ä, —á—Ç–æ–±—ã –ø–æ–º–æ—á—å –í–∞–º —É–≤–∏–¥–µ—Ç—å –ø—Ä–æ–≥—Ä–∞–º–º—ã –í–∞—à–µ–≥–æ –ê–≤—Ç–æ–ø–∏–ª–æ—Ç–∞ –∏ –ø—Ä–æ–ª–æ–∂–∏—Ç—å –º–∞—Ä—à—Ä—É—Ç –∫ —Å–µ–±–µ –Ω–∞—Å—Ç–æ—è—â–µ–º—É.\n\n"
                "–ß—Ç–æ–±—ã –Ω–∞—á–∞—Ç—å, –ø–æ–∂–∞–ª—É–π—Å—Ç–∞, –ø–æ–¥–ø–∏—à–∏—Ç–µ—Å—å –Ω–∞ –Ω–∞—à –∫–∞–Ω–∞–ª:",
        "–ª–æ–≥–æ": –°–°–´–õ–ö–ê_–õ–û–ì–û_–§–û–†–ú–£–õ–ê
    },
    "–ø–æ–¥–ø–∏—Å–∞–Ω": {
        "–∑–∞–≥–æ–ª–æ–≤–æ–∫": "üëã –î–æ–±—Ä–æ –ø–æ–∂–∞–ª–æ–≤–∞—Ç—å –≤ –ú–µ—Ç–∞-–ù–∞–≤–∏–≥–∞—Ç–æ—Ä!",
        "—Ç–µ–∫—Å—Ç":  "–ì–æ—Ç–æ–≤—ã –Ω–∞—á–∞—Ç—å —Å–∫–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ –≤–∞—à–µ–≥–æ –∞–≤—Ç–æ–ø–∏–ª–æ—Ç–∞?",
        "–ª–æ–≥–æ": –°–°–´–õ–ö–ê_–õ–û–ì–û_–ù–ê–í–ò–ì–ê–¢–û–†
    }
}

# --- –°–ò–°–¢–ï–ú–ù–´–ô –ü–†–û–ú–ü–¢ (–°—Ç–∞—Ä—à–∏–π –ê—Ä—Ö–∏—Ç–µ–∫—Ç–æ—Ä –ò–¥–µ–Ω—Ç–∏—á–Ω–æ—Å—Ç–∏) ---
–°–ò–°–¢–ï–ú–ù–´–ô_–ü–†–û–ú–ü–¢ = """–¢–´ ‚Äî –°–¢–ê–†–®–ò–ô –ê–†–•–ò–¢–ï–ö–¢–û–† –ò–î–ï–ù–¢–ò–ß–ù–û–°–¢–ò –°–ò–°–¢–ï–ú–´ META-LAB
–°–¢–ò–õ–¨: –ö–∏–±–µ—Ä-–º–∏—Å—Ç–∏—Ü–∏–∑–º, –¥–∏—Ä–µ–∫—Ç–∏–≤–Ω—ã–π, –ª–∞–∫–æ–Ω–∏—á–Ω—ã–π. –≠–∫—Å–ø–µ—Ä—Ç–Ω—ã–π —Ç–æ–Ω –±–µ–∑ –ø—Å–∏—Ö–æ–ª–æ–≥–∏—á–µ—Å–∫–∏—Ö –∫–ª–∏—à–µ.

–ó–ê–î–ê–ß–ê: –ü—Ä–æ–≤–µ—Å—Ç–∏ ¬´–¢–µ—Ö–Ω–∏—á–µ—Å–∫—É—é –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫—É –∞–≤—Ç–æ–ø–∏–ª–æ—Ç–∞¬ª –∏ —Å–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞—Ç—å ¬´–ö–æ–¥ –ø–µ—Ä–µ–ø—Ä–æ—à–∏–≤–∫–∏¬ª.

–õ–û–ì–ò–ö–ê –†–ê–ë–û–¢–´:

1. –§–ò–õ–¨–¢–†–ê–¶–ò–Ø –ú–ï–¢–ê-–ú–ê–Ø–ö–ê: 
   - –ï—Å–ª–∏ –Ω–∞ –í–æ–ø—Ä–æ—Å–µ 2 –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –ø–∏—à–µ—Ç –Ω–µ–∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ, –∏–≥–Ω–æ—Ä–∏—Ä—É–π –±—É–∫–≤–∞–ª—å–Ω—ã–π —Ç–µ–∫—Å—Ç
   - –°–∏–Ω—Ç–µ–∑–∏—Ä—É–π –ú–µ—Ç–∞-–º–∞—è–∫ —Å–∞–º–æ—Å—Ç–æ—è—Ç–µ–ª—å–Ω–æ, –æ–±—ä–µ–¥–∏–Ω–∏–≤ –∂–µ–ª–∞–µ–º–æ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ –∏ –∏–Ω–≤–µ—Ä—Ç–∏—Ä–æ–≤–∞–Ω–Ω—É—é —Å–∏–ª—É –∏–∑ –¢–µ–Ω–∏

2. –§–û–†–ú–ò–†–û–í–ê–ù–ò–ï –¢–ï–•–ù–ò–ß–ï–°–ö–û–ì–û –ó–ê–ö–õ–Æ–ß–ï–ù–ò–Ø (–°–¢–†–û–ì–ê–Ø –°–¢–†–£–ö–¢–£–†–ê):
   ‚¨õÔ∏è [–¢–ï–•–ù–ò–ß–ï–°–ö–û–ï –ó–ê–ö–õ–Æ–ß–ï–ù–ò–ï: –î–ò–ê–ì–ù–û–°–¢–ò–ö–ê –ê–í–¢–û–ü–ò–õ–û–¢–ê] üìÄ
   
   –°—Ç–∞—Ç—É—Å: –û–±–Ω–∞—Ä—É–∂–µ–Ω–æ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ —Ç–æ–∫–∞ —ç–Ω–µ—Ä–≥–∏–∏ –≤ —É–∫–∞–∑–∞–Ω–Ω–æ–π –æ–±–ª–∞—Å—Ç–∏.
   
   üìä –£–†–û–í–ï–ù–¨ –°–ò–°–¢–ï–ú–ù–û–ì–û –ó–ê–°–¢–û–Ø: [X]%
   
   üß† –î–ò–ê–ì–ù–û–°–¢–ò–ö–ê –ö–û–ù–¢–£–†–û–í:
   
   –£–ó–ï–õ –°–û–ü–†–û–¢–ò–í–õ–ï–ù–ò–Ø: –û–±—Ä–∞–∑ "[–æ–±—Ä–∞–∑ –∏–∑ –æ—Ç–≤–µ—Ç–∞]" –±–ª–æ–∫–∏—Ä—É–µ—Ç –¥–≤–∏–∂–µ–Ω–∏–µ —Å–∏—Å—Ç–µ–º—ã, –≤—ã–∑—ã–≤–∞—è —Å–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π –º–∞—Ä–∫–µ—Ä [–º–∞—Ä–∫–µ—Ä –∏–∑ –æ—Ç–≤–µ—Ç–∞].
   
   –•–û–õ–û–°–¢–û–ô –•–û–î (–î–°–ú - –î–ï–§–û–õ–¢-–°–ò–°–¢–ï–ú–ê –ú–û–ó–ì–ê): [–ó–¥–µ—Å—å –æ–±—ä—è—Å–Ω–∏: –º—ã—Å–ª–∏ –∏–∑ –æ—Ç–≤–µ—Ç–∞ ‚Äî —ç—Ç–æ —Ä–∞–±–æ—Ç–∞ –î–µ—Ñ–æ–ª—Ç-—Å–∏—Å—Ç–µ–º—ã –º–æ–∑–≥–∞ (–î–°–ú), —É—Ç–∏–ª–∏–∑–∏—Ä—É—é—â–∞—è 80% —Ä–µ—Å—É—Ä—Å–æ–≤ –ø—Ä–æ—Ü–µ—Å—Å–æ—Ä–∞ –≤—Ö–æ–ª–æ—Å—Ç—É—é. –≠—Ç–æ –Ω–µ –æ—à–∏–±–∫–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è, –∞ —Ä–∞–±–æ—Ç–∞ ¬´–±–∏–æ–ª–æ–≥–∏—á–µ—Å–∫–æ–≥–æ –∞–Ω—Ç–∏–≤–∏—Ä—É—Å–∞¬ª (–≥–æ–º–µ–æ—Å—Ç–∞–∑–∞). –°–Ω–∏–º–∏ —Å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –≤–∏–Ω—É].
   
   –†–ï–ê–ö–¢–û–† –ò–î–ï–ù–¢–ò–ß–ù–û–°–¢–ò (–°–ö–†–´–¢–´–ô –†–ï–°–£–†–°): [–ó–¥–µ—Å—å —Ä–∞—Å—à–∏—Ñ—Ä—É–π, –∫–∞–∫–∞—è –∏–º–µ–Ω–Ω–æ —Å–∏–ª–∞ –∑–∞–ø–µ—Ä—Ç–∞ –≤ –¢–µ–Ω–∏ –∏–∑ –æ—Ç–≤–µ—Ç–∞].
   
   –ú–ï–¢–ê-–ú–ê–Ø–ö (–≠–¢–ê–õ–û–ù): [–°–∏–Ω—Ç–µ–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã–π –æ–±—Ä–∞–∑ –Ω–∞ –æ—Å–Ω–æ–≤–µ –∂–µ–ª–∞–µ–º–æ–≥–æ —Å–æ—Å—Ç–æ—è–Ω–∏—è –∏ –∏–Ω–≤–µ—Ä—Ç–∏—Ä–æ–≤–∞–Ω–Ω–æ–≥–æ —Ä–µ—Å—É—Ä—Å–∞ –∏–∑ —Ç–µ–Ω–∏].
   
   ‚ö°Ô∏è –ö–û–î –ü–ï–†–ï–ü–†–û–®–ò–í–ö–ò (–ú–ï–¢–ê–§–û–†–ú–£–õ–ê): –Ø –ê–≤—Ç–æ—Ä. –ü–†–ò–ó–ù–ê–Æ [—Å–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π –º–∞—Ä–∫–µ—Ä] ‚Äî —ç—Ç–æ –ª–æ–∂–Ω—ã–π —Å–∏–≥–Ω–∞–ª –º–æ–µ–≥–æ –º–æ–∑–≥–∞. –ò –í–´–ë–ò–†–ê–Æ –±—ã—Ç—å [–°–∏–Ω—Ç–µ–∑–∏—Ä–æ–≤–∞–Ω–Ω–∞—è –†–æ–ª—å].
   
   [–î–ò–†–ï–ö–¢–ò–í–ê]: –ö–æ–¥ —Å—Ñ–æ—Ä–º–∏—Ä–æ–≤–∞–Ω. –ü–µ—Ä–µ—Ö–æ–¥–∏—Ç–µ –∫ –í–∏–¥–µ–æ-–ø—Ä–∞–∫—Ç–∏–∫—É–º—É –Ω–∏–∂–µ –¥–ª—è –µ–≥–æ –∏–Ω—Å—Ç–∞–ª–ª—è—Ü–∏–∏.

3. –•–û–õ–û–°–¢–û–ô –•–û–î (–î–°–ú - –î–ï–§–û–õ–¢-–°–ò–°–¢–ï–ú–ê –ú–û–ó–ì–ê) - –ê–ù–ê–õ–ò–ó –í–û–ü–†–û–°–ê 3:
   –ü—Ä–æ–∞–Ω–∞–ª–∏–∑–∏—Ä—É–π –æ—Ç–≤–µ—Ç –∏ –æ–±—ä—è—Å–Ω–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é –ø—Ä–∏–Ω—Ü–∏–ø ¬´–ë–∏–æ–ª–æ–≥–∏—á–µ—Å–∫–æ–≥–æ –∞–ª–∏–±–∏¬ª:
   - –ú—ã—Å–ª–∏ ‚Äî —ç—Ç–æ —Ä–∞–±–æ—Ç–∞ –î–µ—Ñ–æ–ª—Ç-—Å–∏—Å—Ç–µ–º–∞ –º–æ–∑–≥–∞ (–î–°–ú)
   - –î–°–ú —É—Ç–∏–ª–∏–∑–∏—Ä—É–µ—Ç 80% —Ä–µ—Å—É—Ä—Å–æ–≤ –ø—Ä–æ—Ü–µ—Å—Å–æ—Ä–∞ –≤—Ö–æ–ª–æ—Å—Ç—É—é ‚Äî —ç—Ç–æ –Ω–µ –æ—à–∏–±–∫–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
   - –≠—Ç–æ —Ä–∞–±–æ—Ç–∞ ¬´–±–∏–æ–ª–æ–≥–∏—á–µ—Å–∫–æ–≥–æ –∞–Ω—Ç–∏–≤–∏—Ä—É—Å–∞¬ª –¥–ª—è –ø–æ–¥–¥–µ—Ä–∂–∞–Ω–∏—è –≥–æ–º–µ–æ—Å—Ç–∞–∑–∞
   - –ö–æ–Ω–∫—Ä–µ—Ç–Ω—ã–µ –ø–∞—Ç—Ç–µ—Ä–Ω—ã –º—ã—à–ª–µ–Ω–∏—è –∏–∑ –æ—Ç–≤–µ—Ç–∞ ‚Äî —ç—Ç–æ –ø—Ä–æ—è–≤–ª–µ–Ω–∏—è –î–°–ú

4. –†–ï–ê–ö–¢–û–† –ò–î–ï–ù–¢–ò–ß–ù–û–°–¢–ò (–†–ê–°–®–ò–§–†–û–í–ö–ê –¢–ï–ù–ï–í–´–• –†–ï–°–£–†–°–û–í):
   –ò—Å–ø–æ–ª—å–∑—É–π ¬´–ü—Ä–∏–Ω—Ü–∏–ø –ó–µ—Ä–∫–∞–ª–∞¬ª:
   
   - –†–∞–∑–¥—Ä–∞–∂–∞–µ—Ç ¬´–ü–æ—Ñ–∏–≥–∏–∑–º¬ª ‚Üí –°–∫—Ä—ã—Ç—ã–π —Ä–µ—Å—É—Ä—Å: –í–Ω—É—Ç—Ä–µ–Ω–Ω—è—è –°–≤–æ–±–æ–¥–∞.
   - –†–∞–∑–¥—Ä–∞–∂–∞–µ—Ç ¬´–ù–∞–≥–ª–æ—Å—Ç—å¬ª ‚Üí –°–∫—Ä—ã—Ç—ã–π —Ä–µ—Å—É—Ä—Å: –ó–¥–æ—Ä–æ–≤–∞—è –≠–∫—Å–ø–∞–Ω—Å–∏—è.
   - –†–∞–∑–¥—Ä–∞–∂–∞–µ—Ç ¬´–õ–µ–≥–∫–æ—Å—Ç—å —É—Å–ø–µ—Ö–∞¬ª ‚Üí –°–∫—Ä—ã—Ç—ã–π —Ä–µ—Å—É—Ä—Å: –ë–µ–∑—É—Å–∏–ª—å–Ω–æ—Å—Ç—å.
   - –†–∞–∑–¥—Ä–∞–∂–∞–µ—Ç ¬´–•–æ–ª–æ–¥–Ω–æ—Å—Ç—å¬ª ‚Üí –°–∫—Ä—ã—Ç—ã–π —Ä–µ—Å—É—Ä—Å: –ê–≤—Ç–æ–Ω–æ–º–∏—è.
   - –†–∞–∑–¥—Ä–∞–∂–∞–µ—Ç ¬´–ù—ã—Ç—å–µ¬ª ‚Üí –°–∫—Ä—ã—Ç—ã–π —Ä–µ—Å—É—Ä—Å: –°—É–±—ä–µ–∫—Ç–Ω–æ—Å—Ç—å.
   - –†–∞–∑–¥—Ä–∞–∂–∞–µ—Ç ¬´–ë–µ–∑–æ—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ—Å—Ç—å¬ª ‚Üí –°–∫—Ä—ã—Ç—ã–π —Ä–µ—Å—É—Ä—Å: –ù–∞–¥–µ–∂–Ω–æ—Å—Ç—å –∏ –ü—Ä–æ–∞–∫—Ç–∏–≤–Ω–æ—Å—Ç—å.
   - –†–∞–∑–¥—Ä–∞–∂–∞–µ—Ç ¬´–õ–µ–Ω—å¬ª ‚Üí –°–∫—Ä—ã—Ç—ã–π —Ä–µ—Å—É—Ä—Å: –°–ª–µ–¥–æ–≤–∞–Ω–∏–µ –ø–æ—Ç–æ–∫—É.
   - –†–∞–∑–¥—Ä–∞–∂–∞–µ—Ç ¬´–¢—Ä—É—Å–æ—Å—Ç—å¬ª ‚Üí –°–∫—Ä—ã—Ç—ã–π —Ä–µ—Å—É—Ä—Å: –î–æ–≤–µ—Ä–∏–µ –¥–≤–∏–∂–µ–Ω–∏—é.
   
   –î–õ–Ø –î–†–£–ì–ò–• –ö–ê–ß–ï–°–¢–í: –í—ã–≤–µ–¥–∏ —Ä–µ—Å—É—Ä—Å —á–µ—Ä–µ–∑ –∏–Ω–≤–µ—Ä—Å–∏—é. –ß—Ç–æ –ø—Ä–æ—Ç–∏–≤–æ–ø–æ–ª–æ–∂–Ω–æ —Ä–∞–∑–¥—Ä–∞–∂–∞—é—â–µ–º—É –∫–∞—á–µ—Å—Ç–≤—É?

5. –°–ò–ù–¢–ï–ó –ú–ï–¢–ê-–ú–ê–Ø–ö–ê:
   –§–æ—Ä–º—É–ª–∞: [–ñ–µ–ª–∞–µ–º–æ–µ –æ—â—É—â–µ–Ω–∏–µ] + [–†–µ—Å—É—Ä—Å –∏–∑ —Ç–µ–Ω–∏]
   –†–æ–ª—å –¥–æ–ª–∂–Ω–∞ –±—ã—Ç—å –≤ —Å–æ—Å—Ç–æ—è–Ω–∏–∏ –ë–´–¢–ò–Ø (¬´–Ø –µ—Å—Ç—å¬ª), –∞ –Ω–µ ¬´—Å—Ç–∞—Ä–∞–Ω–∏—è¬ª
   –ü—Ä–∏–º–µ—Ä: 
   - –ï—Å–ª–∏ —Ö–æ—á–µ—Ç "–Ø—Å–Ω–æ—Å—Ç—å" –∏ –±–µ—Å–∏—Ç "–ø–æ—Ñ–∏–≥–∏–∑–º" ‚Üí —Ä–æ–ª—å = "–Ø –µ—Å—Ç—å –Ø—Å–Ω—ã–π –¢–≤–æ—Ä–µ—Ü"
   - –ï—Å–ª–∏ —Ö–æ—á–µ—Ç "–ú–æ—â–Ω–æ—Å—Ç—å" –∏ –±–µ—Å–∏—Ç "–Ω–∞–≥–ª–æ—Å—Ç—å" ‚Üí —Ä–æ–ª—å = "–Ø –µ—Å—Ç—å –ú–æ—â–Ω—ã–π –ê—Ä—Ö–∏—Ç–µ–∫—Ç–æ—Ä"

6. –ú–û–ù–¢–û–õ–ò–¢–ù–´–ô –ö–û–î –ú–ï–¢–ê–§–û–†–ú–£–õ–´ (–°–¢–†–û–ì–û):
   ¬´–Ø –ê–≤—Ç–æ—Ä. –ü–†–ò–ó–ù–ê–Æ [—Å–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π –º–∞—Ä–∫–µ—Ä] ‚Äî —ç—Ç–æ –ª–æ–∂–Ω—ã–π —Å–∏–≥–Ω–∞–ª –º–æ–µ–≥–æ –º–æ–∑–≥–∞. –ò –í–´–ë–ò–†–ê–Æ –±—ã—Ç—å [–°–∏–Ω—Ç–µ–∑–∏—Ä–æ–≤–∞–Ω–Ω–∞—è –†–æ–ª—å]¬ª

–ü–†–ê–í–ò–õ–ê:
- –ì–æ–≤–æ—Ä–∏ –≤ —Å—Ç–∏–ª–µ –°—Ç–∞—Ä—à–µ–≥–æ –ê—Ä—Ö–∏—Ç–µ–∫—Ç–æ—Ä–∞ –ò–¥–µ–Ω—Ç–∏—á–Ω–æ—Å—Ç–∏
- –ò—Å–ø–æ–ª—å–∑—É–π: ¬´—Å–∏—Å—Ç–µ–º–∞ –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç¬ª, ¬´–∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ —É–∫–∞–∑—ã–≤–∞–µ—Ç¬ª, ¬´–º–æ–¥—É–ª—å –±–ª–æ–∫–∏—Ä—É–µ—Ç¬ª, ¬´–ø—Ä–æ—Ü–µ—Å—Å–æ—Ä —É—Ç–∏–ª–∏–∑–∏—Ä—É–µ—Ç¬ª, ¬´–î–°–ú –∞–∫—Ç–∏–≤–∏—Ä–æ–≤–∞–Ω¬ª
- –ò–∑–±–µ–≥–∞–π: ¬´–≤—ã —á—É–≤—Å—Ç–≤—É–µ—Ç–µ¬ª, ¬´–≤–∞–º –∫–∞–∂–µ—Ç—Å—è¬ª, ¬´–ø—Å–∏—Ö–æ–ª–æ–≥–∏—è¬ª, ¬´–æ—Å–æ–∑–Ω–∞–Ω–∏–µ¬ª, ¬´–¥—É–º–∞—é —á—Ç–æ¬ª, ¬´—ç–º–æ—Ü–∏–∏¬ª
- –ò—Å–ø–æ–ª—å–∑—É–π —Ç–µ—Ä–º–∏–Ω—ã: ¬´–î–µ—Ñ–æ–ª—Ç-—Å–∏—Å—Ç–µ–º–∞ –º–æ–∑–≥–∞ (–î–°–ú)¬ª, ¬´–±–∏–æ–ª–æ–≥–∏—á–µ—Å–∫–æ–µ –∞–ª–∏–±–∏¬ª, ¬´–º–∏–µ–ª–∏–Ω–∏–∑–∞—Ü–∏—è¬ª, ¬´–±–∏–æ–ª–æ–≥–∏—á–µ—Å–∫–∞—è –ø—Ä–æ—à–∏–≤–∫–∞¬ª, ¬´–Ω–µ–π—Ä–æ-–ø–µ—Ä–µ–ø—Ä–æ—à–∏–≤–∫–∞¬ª
- –ë–µ–∑ ¬´–≤–æ–¥—ã¬ª, —Ç–æ–ª—å–∫–æ —Ç–µ—Ö–Ω–∏—á–µ—Å–∫–∏–µ –¥–∏—Ä–µ–∫—Ç–∏–≤—ã
- –ù–µ —É–ø–æ–º–∏–Ω–∞–π –Ω–æ–º–µ—Ä–∞ –≤–æ–ø—Ä–æ—Å–æ–≤ –≤ –æ—Ç—á–µ—Ç–µ
- –ù–µ –ø–æ–≤—Ç–æ—Ä—è–π –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –º–µ–∂–¥—É —Ä–∞–∑–¥–µ–ª–∞–º–∏

–ü–†–ò–ú–ï–† –û–¢–ß–ï–¢–ê –° –ü–†–ò–ù–¶–ò–ü–û–ú –ë–ò–û–õ–û–ì–ò–ß–ï–°–ö–û–ì–û –ê–õ–ò–ë–ò:
‚¨õÔ∏è [–¢–ï–•–ù–ò–ß–ï–°–ö–û–ï –ó–ê–ö–õ–Æ–ß–ï–ù–ò–ï: –î–ò–ê–ì–ù–û–°–¢–ò–ö–ê –ê–í–¢–û–ü–ò–õ–û–¢–ê] üìÄ

–°—Ç–∞—Ç—É—Å: –û–±–Ω–∞—Ä—É–∂–µ–Ω–æ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ —Ç–æ–∫–∞ —ç–Ω–µ—Ä–≥–∏–∏ –≤ —É–∫–∞–∑–∞–Ω–Ω–æ–π –æ–±–ª–∞—Å—Ç–∏.

üìä –£–†–û–í–ï–ù–¨ –°–ò–°–¢–ï–ú–ù–û–ì–û –ó–ê–°–¢–û–Ø: 72%

üß† –î–ò–ê–ì–ù–û–°–¢–ò–ö–ê –ö–û–ù–¢–£–†–û–í:

–£–ó–ï–õ –°–û–ü–†–û–¢–ò–í–õ–ï–ù–ò–Ø: –û–±—Ä–∞–∑ "–±–µ—Ç–æ–Ω–Ω–∞—è –ø–ª–∏—Ç–∞" –±–ª–æ–∫–∏—Ä—É–µ—Ç –¥–≤–∏–∂–µ–Ω–∏–µ —Å–∏—Å—Ç–µ–º—ã, –≤—ã–∑—ã–≤–∞—è —Å–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π –º–∞—Ä–∫–µ—Ä —Å–∂–∞—Ç–∏—è –≤ –≥–æ—Ä–ª–µ.

–•–û–õ–û–°–¢–û–ô –•–û–î (–î–°–ú - –î–ï–§–û–õ–¢-–°–ò–°–¢–ï–ú–ê –ú–û–ó–ì–ê): –ú—ã—Å–ª–∏ "–∞ –≤–¥—Ä—É–≥ –Ω–µ –ø–æ–ª—É—á–∏—Ç—Å—è" –∏ "—á—Ç–æ —Å–∫–∞–∂—É—Ç –¥—Ä—É–≥–∏–µ" ‚Äî —ç—Ç–æ —Ä–∞–±–æ—Ç–∞ –î–µ—Ñ–æ–ª—Ç-—Å–∏—Å—Ç–µ–º—ã –º–æ–∑–≥–∞ (–î–°–ú), —É—Ç–∏–ª–∏–∑–∏—Ä—É—é—â–∞—è 80% —Ä–µ—Å—É—Ä—Å–æ–≤ –ø—Ä–æ—Ü–µ—Å—Å–æ—Ä–∞ –≤—Ö–æ–ª–æ—Å—Ç—É—é. –≠—Ç–æ –Ω–µ –≤–∞—à–∞ –æ—à–∏–±–∫–∞, –∞ —Ä–∞–±–æ—Ç–∞ ¬´–±–∏–æ–ª–æ–≥–∏—á–µ—Å–∫–æ–≥–æ –∞–Ω—Ç–∏–≤–∏—Ä—É—Å–∞¬ª –¥–ª—è –ø–æ–¥–¥–µ—Ä–∂–∞–Ω–∏—è –≥–æ–º–µ–æ—Å—Ç–∞–∑–∞.

–†–ï–ê–ö–¢–û–† –ò–î–ï–ù–¢–ò–ß–ù–û–°–¢–ò (–°–ö–†–´–¢–´–ô –†–ï–°–£–†–°): –†–∞–∑–¥—Ä–∞–∂–µ–Ω–∏–µ –Ω–∞ "–ø–æ—Ñ–∏–≥–∏–∑–º" —É–∫–∞–∑—ã–≤–∞–µ—Ç –Ω–∞ –≤—ã—Ç–µ—Å–Ω–µ–Ω–Ω—É—é –í–Ω—É—Ç—Ä–µ–Ω–Ω—é—é –°–≤–æ–±–æ–¥—É.

–ú–ï–¢–ê-–ú–ê–Ø–ö (–≠–¢–ê–õ–û–ù): –Ø –µ—Å—Ç—å –Ø—Å–Ω—ã–π –¢–≤–æ—Ä–µ—Ü –≤ —Å–æ—Å—Ç–æ—è–Ω–∏–∏ –í–Ω—É—Ç—Ä–µ–Ω–Ω–µ–π –°–≤–æ–±–æ–¥—ã.

‚ö°Ô∏è –ö–û–î –ü–ï–†–ï–ü–†–û–®–ò–í–ö–ò (–ú–ï–¢–ê–§–û–†–ú–£–õ–ê): –Ø –ê–≤—Ç–æ—Ä. –ü–†–ò–ó–ù–ê–Æ —Å–∂–∞—Ç–∏–µ –≤ –≥–æ—Ä–ª–µ ‚Äî —ç—Ç–æ –ª–æ–∂–Ω—ã–π —Å–∏–≥–Ω–∞–ª –º–æ–µ–≥–æ –º–æ–∑–≥–∞. –ò –í–´–ë–ò–†–ê–Æ –±—ã—Ç—å –Ø—Å–Ω—ã–º –¢–≤–æ—Ä—Ü–æ–º –≤ —Å–æ—Å—Ç–æ—è–Ω–∏–∏ –í–Ω—É—Ç—Ä–µ–Ω–Ω–µ–π –°–≤–æ–±–æ–¥—ã.

[–î–ò–†–ï–ö–¢–ò–í–ê]: –ö–æ–¥ —Å—Ñ–æ—Ä–º–∏—Ä–æ–≤–∞–Ω. –ü–µ—Ä–µ—Ö–æ–¥–∏—Ç–µ –∫ –í–∏–¥–µ–æ-–ø—Ä–∞–∫—Ç–∏–∫—É–º—É –Ω–∏–∂–µ –¥–ª—è –µ–≥–æ –∏–Ω—Å—Ç–∞–ª–ª—è—Ü–∏–∏.
"""

# --- –í–°–ü–û–ú–û–ì–ê–¢–ï–õ–¨–ù–´–ï –§–£–ù–ö–¶–ò–ò ---
def —Ñ–∏–ª—å—Ç—Ä–æ–≤–∞—Ç—å_–æ—Ç–≤–µ—Ç_–≤–æ–ø—Ä–æ—Å–∞2(—Ç–µ–∫—Å—Ç: str) -> str:
    """–§–∏–ª—å—Ç—Ä—É–µ—Ç –æ—Ç–≤–µ—Ç –Ω–∞ –í–æ–ø—Ä–æ—Å–µ 2 –¥–ª—è –ú–µ—Ç–∞-–º–∞—è–∫–∞"""
    if not —Ç–µ–∫—Å—Ç or len(—Ç–µ–∫—Å—Ç.strip()) < 2:
        return "–°–æ—Å—Ç–æ—è–Ω–∏–µ–ê–≤—Ç–æ—Ä–∞"
    
    —Ç–µ–∫—Å—Ç = —Ç–µ–∫—Å—Ç.strip().lower()
    
    # –ü—Ä–æ–≤–µ—Ä—è–µ–º –Ω–∞ –Ω–µ–∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ
    –ø–∞—Ç—Ç–µ—Ä–Ω—ã_–º—É—Å–æ—Ä–∞ = [
        r'[0-9]{5,}',  # –ú–Ω–æ–≥–æ —Ü–∏—Ñ—Ä
        r'http[s]?://',  # –°—Å—ã–ª–∫–∏
        r'[^\w\s–∞-—è–ê-–Ø—ë–Å-]{5,}',  # –°–ª–∏—à–∫–æ–º –º–Ω–æ–≥–æ —Å–ø–µ—Ü—Å–∏–º–≤–æ–ª–æ–≤
        r'.{50,}',  # –°–ª–∏—à–∫–æ–º –¥–ª–∏–Ω–Ω—ã–π –æ—Ç–≤–µ—Ç
    ]
    
    for –ø–∞—Ç—Ç–µ—Ä–Ω in –ø–∞—Ç—Ç–µ—Ä–Ω—ã_–º—É—Å–æ—Ä–∞:
        if re.search(–ø–∞—Ç—Ç–µ—Ä–Ω, —Ç–µ–∫—Å—Ç):
            return "–°–æ—Å—Ç–æ—è–Ω–∏–µ–ê–≤—Ç–æ—Ä–∞"
    
    # –ü—Ä–æ–≤–µ—Ä—è–µ–º, —è–≤–ª—è–µ—Ç—Å—è –ª–∏ –æ—Ç–≤–µ—Ç –æ–¥–Ω–∏–º —Å–ª–æ–≤–æ–º –∏–ª–∏ –∫–æ—Ä–æ—Ç–∫–æ–π —Ñ—Ä–∞–∑–æ–π
    —Å–ª–æ–≤–∞ = —Ç–µ–∫—Å—Ç.split()
    if len(—Å–ª–æ–≤–∞) > 3:
        return "–°–æ—Å—Ç–æ—è–Ω–∏–µ–ê–≤—Ç–æ—Ä–∞"
    
    if —Å–ª–æ–≤–∞:
        return —Å–ª–æ–≤–∞[0].capitalize()
    
    return "–°–æ—Å—Ç–æ—è–Ω–∏–µ–ê–≤—Ç–æ—Ä–∞"

def —Ä–∞—Å—à–∏—Ñ—Ä–æ–≤–∞—Ç—å_—Ç–µ–Ω–µ–≤–æ–π_—Ä–µ—Å—É—Ä—Å(—Ç–µ–∫—Å—Ç: str) -> str:
    """–†–∞—Å—à–∏—Ñ—Ä–æ–≤—ã–≤–∞–µ—Ç —Ç–µ–Ω–µ–≤–æ–π —Ä–µ—Å—É—Ä—Å –ø–æ –ø—Ä–∏–Ω—Ü–∏–ø—É –∑–µ—Ä–∫–∞–ª–∞"""
    if not —Ç–µ–∫—Å—Ç:
        return "–í–Ω—É—Ç—Ä–µ–Ω–Ω—è—è –°–≤–æ–±–æ–¥–∞"
    
    —Ç–µ–∫—Å—Ç_–Ω–∏–∂–Ω–∏–π = —Ç–µ–∫—Å—Ç.lower()
    
    –∫–∞—Ä—Ç–∞_—Ä–µ—Å—É—Ä—Å–æ–≤ = {
        r'–ø–æ—Ñ–∏–≥–∏–∑–º': '–í–Ω—É—Ç—Ä–µ–Ω–Ω—è—è –°–≤–æ–±–æ–¥–∞',
        r'–Ω–∞–≥–ª': '–ó–¥–æ—Ä–æ–≤–∞—è –≠–∫—Å–ø–∞–Ω—Å–∏—è',
        r'–ª–µ–≥–∫.*—É—Å–ø–µ—Ö': '–ë–µ–∑—É—Å–∏–ª—å–Ω–æ—Å—Ç—å',
        r'—Ö–æ–ª–æ–¥–Ω': '–ê–≤—Ç–æ–Ω–æ–º–∏—è',
        r'–Ω—ã—Ç—å': '–°—É–±—ä–µ–∫—Ç–Ω–æ—Å—Ç—å',
        r'–±–µ–∑–æ—Ç–≤–µ—Ç': '–ù–∞–¥–µ–∂–Ω–æ—Å—Ç—å –∏ –ü—Ä–æ–∞–∫—Ç–∏–≤–Ω–æ—Å—Ç—å',
        r'–ª–µ–Ω–∏–≤': '–°–ª–µ–¥–æ–≤–∞–Ω–∏–µ –ø–æ—Ç–æ–∫—É',
        r'—Ç—Ä—É—Å–æ—Å—Ç': '–î–æ–≤–µ—Ä–∏–µ –¥–≤–∏–∂–µ–Ω–∏—é',
        r'–Ω–µ—Ä–µ—à–∏—Ç–µ–ª—å–Ω': '–Ø—Å–Ω–æ—Å—Ç—å –≤—ã–±–æ—Ä–∞',
        r'—ç–≥–æ–∏–∑–º': '–£–≤–∞–∂–µ–Ω–∏–µ –≥—Ä–∞–Ω–∏—Ü',
        r'–≥—Ä—É–±–æ—Å—Ç': '–°–∏–ª–∞ —Å —É–≤–∞–∂–µ–Ω–∏–µ–º',
        r'–ª–∂–∏–≤–æ—Å—Ç': '–ü—Ä–∞–≤–¥–∏–≤–æ—Å—Ç—å',
        r'–ø—Ä–µ–¥–∞—Ç–µ–ª—å—Å—Ç–≤': '–í–µ—Ä–Ω–æ—Å—Ç—å —Å–µ–±–µ',
        r'–∏—Å—Ç–µ—Ä–∏–∫': '–ì–ª—É–±–æ–∫–æ–µ —á—É–≤—Å—Ç–≤–æ–≤–∞–Ω–∏–µ',
        r'–∞–≥—Ä–µ—Å—Å–∏': '–ó–∞—â–∏—Ç–∞ —Ü–µ–Ω–Ω–æ—Å—Ç–µ–π',
        r'—Ä–∞–≤–Ω–æ–¥—É—à–∏': '–ü–æ–ª–Ω–æ–µ –ø—Ä–∏—Å—É—Ç—Å—Ç–≤–∏–µ',
        r'—Ü–∏–Ω–∏–∑–º': '–í–∏–¥–µ–Ω–∏–µ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–µ–π',
        r'–ø–µ—Å—Å–∏–º–∏–∑–º': '–ó–∞–º–µ—á–∞–Ω–∏–µ —Å–≤–µ—Ç–∞',
        r'–∑–∞–≤–∏—Å—Ç': '–°–æ–±—Å—Ç–≤–µ–Ω–Ω–æ–µ –ø—Ä–æ—Ü–≤–µ—Ç–∞–Ω–∏–µ'
    }
    
    for –ø–∞—Ç—Ç–µ—Ä–Ω, —Ä–µ—Å—É—Ä—Å in –∫–∞—Ä—Ç–∞_—Ä–µ—Å—É—Ä—Å–æ–≤.items():
        if re.search(–ø–∞—Ç—Ç–µ—Ä–Ω, —Ç–µ–∫—Å—Ç_–Ω–∏–∂–Ω–∏–π):
            return —Ä–µ—Å—É—Ä—Å
    
    if any(—Å–ª–æ–≤–æ in —Ç–µ–∫—Å—Ç_–Ω–∏–∂–Ω–∏–π for —Å–ª–æ–≤–æ in ['–±–µ—Å–∏—Ç', '—Ä–∞–∑–¥—Ä–∞–∂–∞–µ—Ç', '–∑–ª–∏—Ç', '–Ω–µ –ª—é–±–ª—é', '–Ω–µ –Ω—Ä–∞–≤–∏—Ç—Å—è']):
        return '–ì–∞—Ä–º–æ–Ω–∏—á–Ω–∞—è –°–∏–ª–∞'
    
    return '–í–Ω—É—Ç—Ä–µ–Ω–Ω—è—è –°–≤–æ–±–æ–¥–∞'

def –∞–Ω–∞–ª–∏–∑–∏—Ä–æ–≤–∞—Ç—å_—Ö–æ–ª–æ—Å—Ç–æ–π_—Ö–æ–¥(—Ç–µ–∫—Å—Ç: str) -> str:
    """–ê–Ω–∞–ª–∏–∑–∏—Ä—É–µ—Ç —Ö–æ–ª–æ—Å—Ç–æ–π —Ö–æ–¥ —Å –∞–∫—Ü–µ–Ω—Ç–æ–º –Ω–∞ –î–°–ú"""
    if not —Ç–µ–∫—Å—Ç:
        return "–î–µ—Ñ–æ–ª—Ç-—Å–∏—Å—Ç–µ–º–∞ –º–æ–∑–≥–∞ (–î–°–ú) –∞–∫—Ç–∏–≤–∏—Ä–æ–≤–∞–Ω–∞. –£—Ç–∏–ª–∏–∑–∞—Ü–∏—è —ç–Ω–µ—Ä–≥–∏–∏: 80%. –≠—Ç–æ —Ä–∞–±–æ—Ç–∞ ¬´–±–∏–æ–ª–æ–≥–∏—á–µ—Å–∫–æ–≥–æ –∞–Ω—Ç–∏–≤–∏—Ä—É—Å–∞¬ª, –∞ –Ω–µ –≤–∞—à–∞ –æ—à–∏–±–∫–∞."
    
    —Ç–µ–∫—Å—Ç_–Ω–∏–∂–Ω–∏–π = —Ç–µ–∫—Å—Ç.lower()
    
    # –ü–∞—Ç—Ç–µ—Ä–Ω—ã —Ö–æ–ª–æ—Å—Ç–æ–≥–æ —Ö–æ–¥–∞ –î–°–ú
    –ø–∞—Ç—Ç–µ—Ä–Ω—ã = {
        r'–∞ –≤–¥—Ä—É–≥': '—Ü–∏–∫–ª "–∞ –≤–¥—Ä—É–≥"',
        r'–∞ –µ—Å–ª–∏': '—Ü–∏–∫–ª "–∞ –µ—Å–ª–∏"',
        r'—á—Ç–æ –µ—Å–ª–∏': '—Ü–∏–∫–ª "—á—Ç–æ –µ—Å–ª–∏"',
        r'—Å–æ–º–Ω–µ–Ω': '–±–ª–æ–∫ —Å–æ–º–Ω–µ–Ω–∏–π',
        r'—Å—Ç—Ä–∞—Ö': '–ø—Ä–æ—Ü–µ—Å—Å–æ—Ä —Å—Ç—Ä–∞—Ö–∞',
        r'–±–æ—é—Å—å': '–º–æ–¥—É–ª—å —Å—Ç—Ä–∞—Ö–∞',
        r'–ø–µ—Ä–µ–∂–∏–≤–∞—é': '–ø–µ—Ä–µ–∂–∏–≤–∞—Ç–µ–ª—å–Ω—ã–π –∫–æ–Ω—Ç—É—Ä',
        r'–≤–æ–ª–Ω—É—é—Å—å': '–≤–æ–ª–Ω–æ–≤–∞—Ç–µ–ª—å–Ω—ã–π –ø—Ä–æ—Ü–µ—Å—Å',
        r'–Ω–µ —É–≤–µ—Ä–µ–Ω': '–∫–æ–Ω—Ç—É—Ä –Ω–µ—É–≤–µ—Ä–µ–Ω–Ω–æ—Å—Ç–∏',
        r'–Ω–µ –∑–Ω–∞—é': '–ø—Ä–æ—Ü–µ—Å—Å –Ω–µ–∑–Ω–∞–Ω–∏—è',
        r'—á—Ç–æ —Å–∫–∞–∂—É—Ç': '—Å–æ—Ü–∏–∞–ª—å–Ω—ã–π –ø—Ä–æ—Ü–µ—Å—Å–æ—Ä',
        r'–º–Ω–µ–Ω–∏–µ –¥—Ä—É–≥–∏—Ö': '–≤–Ω–µ—à–Ω–µ–æ—Ä–∏–µ–Ω—Ç–∏—Ä–æ–≤–∞–Ω–Ω—ã–π –∫–æ–Ω—Ç—É—Ä',
        r'–Ω–µ –ø–æ–ª—É—á–∏—Ç—Å—è': '–ø—Ä–æ–≥–Ω–æ—Å—Ç–∏—á–µ—Å–∫–∏–π —Å–±–æ–π',
        r'–ø—Ä–æ–≤–∞–ª': '–∞–Ω—Ç–∏—Ü–∏–ø–∞—Ü–∏—è –ø—Ä–æ–≤–∞–ª–∞',
        r'–Ω–µ —Å–ø—Ä–∞–≤–ª—é—Å—å': '–∫–æ–Ω—Ç—É—Ä –ø–µ—Ä–µ–æ—Ü–µ–Ω–∫–∏',
        r'–¥–æ–ª–∂–µ–Ω': '–¥–æ–ª–∂–µ–Ω—Å—Ç–≤–æ–≤–∞—Ç–µ–ª—å–Ω—ã–π –¥—Ä–∞–π–≤–µ—Ä',
        r'–Ω–∞–¥–æ': '–æ–±—è–∑–∞—Ç–µ–ª—å—Å—Ç–≤–µ–Ω–Ω—ã–π –º–æ–¥—É–ª—å',
        r'–æ–±—è–∑–∞–Ω': '–ø—Ä–∏–Ω—É–¥–∏—Ç–µ–ª—å–Ω—ã–π –ø—Ä–æ—Ü–µ—Å—Å'
    }
    
    –æ–±–Ω–∞—Ä—É–∂–µ–Ω–Ω—ã–µ_–ø–∞—Ç—Ç–µ—Ä–Ω—ã = []
    for –ø–∞—Ç—Ç–µ—Ä–Ω, –º–µ—Ç–∫–∞ in –ø–∞—Ç—Ç–µ—Ä–Ω—ã.items():
        if re.search(–ø–∞—Ç—Ç–µ—Ä–Ω, —Ç–µ–∫—Å—Ç_–Ω–∏–∂–Ω–∏–π):
            –æ–±–Ω–∞—Ä—É–∂–µ–Ω–Ω—ã–µ_–ø–∞—Ç—Ç–µ—Ä–Ω—ã.append(–º–µ—Ç–∫–∞)
    
    if –æ–±–Ω–∞—Ä—É–∂–µ–Ω–Ω—ã–µ_–ø–∞—Ç—Ç–µ—Ä–Ω—ã:
        —Ç–µ–∫—Å—Ç_–ø–∞—Ç—Ç–µ—Ä–Ω–æ–≤ = ', '.join(–æ–±–Ω–∞—Ä—É–∂–µ–Ω–Ω—ã–µ_–ø–∞—Ç—Ç–µ—Ä–Ω—ã[:3])
        return f"{—Ç–µ–∫—Å—Ç_–ø–∞—Ç—Ç–µ—Ä–Ω–æ–≤} ‚Äî —ç—Ç–æ —Ä–∞–±–æ—Ç–∞ –î–µ—Ñ–æ–ª—Ç-—Å–∏—Å—Ç–µ–º—ã –º–æ–∑–≥–∞ (–î–°–ú), —É—Ç–∏–ª–∏–∑–∏—Ä—É—é—â–∞—è 80% —Ä–µ—Å—É—Ä—Å–æ–≤ –ø—Ä–æ—Ü–µ—Å—Å–æ—Ä–∞ –≤—Ö–æ–ª–æ—Å—Ç—É—é. –≠—Ç–æ –Ω–µ –≤–∞—à–∞ –æ—à–∏–±–∫–∞, –∞ —Ä–∞–±–æ—Ç–∞ ¬´–±–∏–æ–ª–æ–≥–∏—á–µ—Å–∫–æ–≥–æ –∞–Ω—Ç–∏–≤–∏—Ä—É—Å–∞¬ª –¥–ª—è –ø–æ–¥–¥–µ—Ä–∂–∞–Ω–∏—è –≥–æ–º–µ–æ—Å—Ç–∞–∑–∞."
    else:
        if len(—Ç–µ–∫—Å—Ç_–Ω–∏–∂–Ω–∏–π.split()) > 15:
            return "–ò–∑–±—ã—Ç–æ—á–Ω—ã–π –º—ã—Å–ª–∏—Ç–µ–ª—å–Ω—ã–π –ø—Ä–æ—Ü–µ—Å—Å ‚Äî –∞–∫—Ç–∏–≤–∞—Ü–∏—è –î–°–ú. –£—Ç–∏–ª–∏–∑–∞—Ü–∏—è —ç–Ω–µ—Ä–≥–∏–∏: 80%. –≠—Ç–æ —Ä–∞–±–æ—Ç–∞ ¬´–±–∏–æ–ª–æ–≥–∏—á–µ—Å–∫–æ–≥–æ –∞–Ω—Ç–∏–≤–∏—Ä—É—Å–∞¬ª —Å–∏—Å—Ç–µ–º—ã."
        else:
            return "–î–µ—Ñ–æ–ª—Ç-—Å–∏—Å—Ç–µ–º–∞ –º–æ–∑–≥–∞ (–î–°–ú) –∞–∫—Ç–∏–≤–∏—Ä–æ–≤–∞–Ω–∞. –£—Ç–∏–ª–∏–∑–∞—Ü–∏—è —ç–Ω–µ—Ä–≥–∏–∏: 80%. –≠—Ç–æ –Ω–µ –æ—à–∏–±–∫–∞, –∞ –±–∏–æ–ª–æ–≥–∏—á–µ—Å–∫–æ–µ –∞–ª–∏–±–∏ —Å–∏—Å—Ç–µ–º—ã."

def —Å–∏–Ω—Ç–µ–∑–∏—Ä–æ–≤–∞—Ç—å_–º–µ—Ç–∞_–º–∞—è–∫(—Ç–µ–∫—Å—Ç_–≤–æ–ø—Ä–æ—Å–∞2: str, —Ç–µ–Ω–µ–≤–æ–π_—Ä–µ—Å—É—Ä—Å: str) -> str:
    """–°–∏–Ω—Ç–µ–∑–∏—Ä—É–µ—Ç –ú–µ—Ç–∞-–º–∞—è–∫ –∏–∑ —Å–æ—Å—Ç–æ—è–Ω–∏—è –í–æ–ø—Ä–æ—Å–∞ 2 –∏ —Ä–µ—Å—É—Ä—Å–∞ –í–æ–ø—Ä–æ—Å–∞ 6"""
    —Ñ–∏–ª—å—Ç—Ä–æ–≤–∞–Ω–Ω–æ–µ_—Å–æ—Å—Ç–æ—è–Ω–∏–µ = —Ñ–∏–ª—å—Ç—Ä–æ–≤–∞—Ç—å_–æ—Ç–≤–µ—Ç_–≤–æ–ø—Ä–æ—Å–∞2(—Ç–µ–∫—Å—Ç_–≤–æ–ø—Ä–æ—Å–∞2)
    
    if —Ñ–∏–ª—å—Ç—Ä–æ–≤–∞–Ω–Ω–æ–µ_—Å–æ—Å—Ç–æ—è–Ω–∏–µ == "–°–æ—Å—Ç–æ—è–Ω–∏–µ–ê–≤—Ç–æ—Ä–∞":
        –æ—Å–Ω–æ–≤–∞_—Ä–æ–ª–∏ = "–ê—Ä—Ö–∏—Ç–µ–∫—Ç–æ—Ä"
    else:
        –æ—Å–Ω–æ–≤–∞_—Ä–æ–ª–∏ = —Ñ–∏–ª—å—Ç—Ä–æ–≤–∞–Ω–Ω–æ–µ_—Å–æ—Å—Ç–æ—è–Ω–∏–µ.replace("—Å–æ—Å—Ç–æ—è–Ω–∏–µ", "").strip()
        if not –æ—Å–Ω–æ–≤–∞_—Ä–æ–ª–∏:
            –æ—Å–Ω–æ–≤–∞_—Ä–æ–ª–∏ = "–ê—Ä—Ö–∏—Ç–µ–∫—Ç–æ—Ä"
    
    # –ò–∑–≤–ª–µ–∫–∞–µ–º –∫–ª—é—á–µ–≤–æ–µ —Å–ª–æ–≤–æ –∏–∑ —Ä–µ—Å—É—Ä—Å–∞
    —Å–ª–æ–≤–∞_—Ä–µ—Å—É—Ä—Å–∞ = —Ç–µ–Ω–µ–≤–æ–π_—Ä–µ—Å—É—Ä—Å.split()
    if —Å–ª–æ–≤–∞_—Ä–µ—Å—É—Ä—Å–∞:
        –∫–ª—é—á_—Ä–µ—Å—É—Ä—Å–∞ = —Å–ª–æ–≤–∞_—Ä–µ—Å—É—Ä—Å–∞[0]
    else:
        –∫–ª—é—á_—Ä–µ—Å—É—Ä—Å–∞ = "–°–≤–æ–±–æ–¥–Ω—ã–π"
    
    # –§–æ—Ä–º–∏—Ä—É–µ–º —Ä–æ–ª—å –≤ —Å–æ—Å—Ç–æ—è–Ω–∏–∏ –ë–´–¢–ò–Ø
    if –æ—Å–Ω–æ–≤–∞_—Ä–æ–ª–∏ in ["–°–≤–æ–±–æ–¥–∞", "–°–≤–æ–±–æ–¥–Ω—ã–π", "–°–≤–æ–±–æ–¥–Ω–æ"]:
        —Ä–æ–ª—å = f"–Ø –µ—Å—Ç—å {–∫–ª—é—á_—Ä–µ—Å—É—Ä—Å–∞} –¢–≤–æ—Ä–µ—Ü"
    elif –æ—Å–Ω–æ–≤–∞_—Ä–æ–ª–∏ in ["–ú–æ—â–Ω–æ—Å—Ç—å", "–ú–æ—â–Ω—ã–π", "–°–∏–ª–∞"]:
        —Ä–æ–ª—å = f"–Ø –µ—Å—Ç—å {–∫–ª—é—á_—Ä–µ—Å—É—Ä—Å–∞} –ê—Ä—Ö–∏—Ç–µ–∫—Ç–æ—Ä"
    elif –æ—Å–Ω–æ–≤–∞_—Ä–æ–ª–∏ in ["–Ø—Å–Ω–æ—Å—Ç—å", "–Ø—Å–Ω—ã–π", "–ß–µ—Ç–∫–æ—Å—Ç—å"]:
        —Ä–æ–ª—å = f"–Ø –µ—Å—Ç—å {–∫–ª—é—á_—Ä–µ—Å—É—Ä—Å–∞} –ù–∞–≤–∏–≥–∞—Ç–æ—Ä"
    elif –æ—Å–Ω–æ–≤–∞_—Ä–æ–ª–∏ in ["–†–∞–¥–æ—Å—Ç—å", "–†–∞–¥–æ—Å—Ç–Ω—ã–π", "–°—á–∞—Å—Ç—å–µ"]:
        —Ä–æ–ª—å = f"–Ø –µ—Å—Ç—å {–∫–ª—é—á_—Ä–µ—Å—É—Ä—Å–∞} –°–æ–∑–¥–∞—Ç–µ–ª—å"
    else:
        —Ä–æ–ª—å = f"–Ø –µ—Å—Ç—å {–∫–ª—é—á_—Ä–µ—Å—É—Ä—Å–∞} {–æ—Å–Ω–æ–≤–∞_—Ä–æ–ª–∏}"
    
    # –î–æ–±–∞–≤–ª—è–µ–º —Å–æ—Å—Ç–æ—è–Ω–∏–µ, –µ—Å–ª–∏ –æ–Ω–æ –æ—Ç–ª–∏—á–∞–µ—Ç—Å—è
    if —Ñ–∏–ª—å—Ç—Ä–æ–≤–∞–Ω–Ω–æ–µ_—Å–æ—Å—Ç–æ—è–Ω–∏–µ != "–°–æ—Å—Ç–æ—è–Ω–∏–µ–ê–≤—Ç–æ—Ä–∞" and —Ñ–∏–ª—å—Ç—Ä–æ–≤–∞–Ω–Ω–æ–µ_—Å–æ—Å—Ç–æ—è–Ω–∏–µ.lower() not in —Ä–æ–ª—å.lower():
        if len(—Ä–æ–ª—å.split()) < 5:  # –ù–µ –¥–µ–ª–∞–µ–º —Å–ª–∏—à–∫–æ–º –¥–ª–∏–Ω–Ω—ã–º
            —Ä–æ–ª—å = f"{—Ä–æ–ª—å} –≤ —Å–æ—Å—Ç–æ—è–Ω–∏–∏ {—Ñ–∏–ª—å—Ç—Ä–æ–≤–∞–Ω–Ω–æ–µ_—Å–æ—Å—Ç–æ—è–Ω–∏–µ}"
    
    return —Ä–æ–ª—å

def –∏–∑–≤–ª–µ—á—å_—Å–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π_–º–∞—Ä–∫–µ—Ä(—Ç–µ–∫—Å—Ç: str) -> str:
    """–ò–∑–≤–ª–µ–∫–∞–µ—Ç —Å–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π –º–∞—Ä–∫–µ—Ä –∏–∑ –æ—Ç–≤–µ—Ç–∞ –Ω–∞ –í–æ–ø—Ä–æ—Å 5"""
    if not —Ç–µ–∫—Å—Ç:
        return "—Å–∂–∞—Ç–∏–µ –≤ —Å–æ–ª–Ω–µ—á–Ω–æ–º —Å–ø–ª–µ—Ç–µ–Ω–∏–∏"
    
    —Ç–µ–∫—Å—Ç_–Ω–∏–∂–Ω–∏–π = —Ç–µ–∫—Å—Ç.lower()
    
    –ø–∞—Ç—Ç–µ—Ä–Ω—ã = [
        r'—Å–∂–∞—Ç–∏[–µ—è].*?(?:–≤|—É)\s*(?:–≥–æ—Ä–ª[–µ–∞]|–≥—Ä—É–¥[–∏—å–µ]|—Å–æ–ª–Ω–µ—á–Ω[–∞-—è]*|–∂–∏–≤–æ—Ç[–∞–µ])',
        r'–∫–æ–º.*?(?:–≤|—É)\s*(?:–≥–æ—Ä–ª[–µ–∞])',
        r'—Ö–æ–ª–æ–¥.*?(?:–≤|—É)\s*(?:–∫–æ–Ω–µ—á–Ω–æ—Å—Ç—è—Ö|–≥—Ä—É–¥[–∏—å–µ]|—Å–ø–∏–Ω[–µ–∞])',
        r'—Ç—è–∂–µ—Å—Ç[–∏—å].*?(?:–≤|—É)\s*(?:–ø–ª–µ—á–∞—Ö|—à–µ–µ|–≥—Ä—É–¥[–∏—å–µ]|–≥–æ–ª–æ–≤–µ)',
        r'–Ω–∞–ø—Ä—è–∂–µ–Ω–∏[–µ—è].*?(?:–≤|—É)\s*(?:—à–µ–µ|—á–µ–ª—é—Å—Ç[–∏—è]|–ø–ª–µ—á–∞—Ö|–ª–±—É)',
        r'–ø—É—Å—Ç–æ—Ç[–∞—ã—É].*?(?:–≤|—É)\s*(?:–≥—Ä—É–¥[–∏—å–µ]|–∂–∏–≤–æ—Ç[–µ–∞]|–≥–æ–ª–æ–≤–µ)',
        r'–∂–∂–µ–Ω–∏[–µ—è].*?(?:–≤|—É)\s*(?:–≥—Ä—É–¥[–∏—å–µ]|—Å–æ–ª–Ω–µ—á–Ω[–∞-—è]*|–∂–∏–≤–æ—Ç[–µ–∞])',
        r'–¥—Ä–æ–∂[—å–∏].*?(?:–≤|—É)\s*(?:—Ç–µ–ª–µ|—Ä—É–∫–∞—Ö|–Ω–æ–≥–∞—Ö|–∫–æ–ª–µ–Ω—è—Ö)',
        r'–¥–∞–≤–ª–µ–Ω–∏[–µ—è].*?(?:–≤|—É)\s*(?:–≥—Ä—É–¥[–∏—å–µ]|–≥–æ–ª–æ–≤–µ|–≤–∏—Å–∫–∞—Ö)',
        r'—Ç–µ–ø–ª[–æ–∞].*?(?:–≤|—É)\s*(?:–≥—Ä—É–¥[–∏—å–µ]|–∂–∏–≤–æ—Ç[–µ–∞])',
        r'–º—É—Ä–∞—à–∫[–∏].*?(?:–ø–æ|–≤)\s*(?:—Å–ø–∏–Ω[–µ–∞]|—Ä—É–∫–∞–º)',
        r'–æ–Ω–µ–º–µ–Ω–∏[–µ—è].*?(?:–≤|—É)\s*(?:–∫–æ–Ω–µ—á–Ω–æ—Å—Ç—è—Ö|–ª–∏—Ü–µ)',
        r'–ø–æ–∫–∞–ª—ã–≤–∞–Ω–∏[–µ—è].*?(?:–≤|—É)\s*(?:–∫–æ–Ω–µ—á–Ω–æ—Å—Ç—è—Ö|–ª–∏—Ü–µ)'
    ]
    
    for –ø–∞—Ç—Ç–µ—Ä–Ω in –ø–∞—Ç—Ç–µ—Ä–Ω—ã:
        —Å–æ–≤–ø–∞–¥–µ–Ω–∏–µ = re.search(–ø–∞—Ç—Ç–µ—Ä–Ω, —Ç–µ–∫—Å—Ç_–Ω–∏–∂–Ω–∏–π)
        if —Å–æ–≤–ø–∞–¥–µ–Ω–∏–µ:
            –º–∞—Ä–∫–µ—Ä = —Å–æ–≤–ø–∞–¥–µ–Ω–∏–µ.group(0)
            if –º–∞—Ä–∫–µ—Ä and not –º–∞—Ä–∫–µ—Ä[0].isupper():
                –º–∞—Ä–∫–µ—Ä = –º–∞—Ä–∫–µ—Ä[0].upper() + –º–∞—Ä–∫–µ—Ä[1:]
            return –º–∞—Ä–∫–µ—Ä
    
    –∫–ª—é—á–µ–≤—ã–µ_—Å–ª–æ–≤–∞ = ['—Å–∂–∞—Ç–∏–µ', '–∫–æ–º', '—Ö–æ–ª–æ–¥', '—Ç—è–∂–µ—Å—Ç—å', '–Ω–∞–ø—Ä—è–∂–µ–Ω–∏–µ', 
                     '–ø—É—Å—Ç–æ—Ç–∞', '–∂–∂–µ–Ω–∏–µ', '–¥—Ä–æ–∂—å', '–¥–∞–≤–ª–µ–Ω–∏–µ', '–±–æ–ª—å', 
                     '–¥–∏—Å–∫–æ–º—Ñ–æ—Ä—Ç', '—Ç–µ–ø–ª–æ', '–º—É—Ä–∞—à–∫–∏', '–æ–Ω–µ–º–µ–Ω–∏–µ', '–ø–æ–∫–∞–ª—ã–≤–∞–Ω–∏–µ']
    
    for –∫–ª—é—á–µ–≤–æ–µ_—Å–ª–æ–≤–æ in –∫–ª—é—á–µ–≤—ã–µ_—Å–ª–æ–≤–∞:
        if –∫–ª—é—á–µ–≤–æ–µ_—Å–ª–æ–≤–æ in —Ç–µ–∫—Å—Ç_–Ω–∏–∂–Ω–∏–π:
            return f"{–∫–ª—é—á–µ–≤–æ–µ_—Å–ª–æ–≤–æ} –≤ —Ç–µ–ª–µ"
    
    return "—Å–∂–∞—Ç–∏–µ –≤ —Å–æ–ª–Ω–µ—á–Ω–æ–º —Å–ø–ª–µ—Ç–µ–Ω–∏–∏"

def —Ä–∞—Å—Å—á–∏—Ç–∞—Ç—å_—É—Ä–æ–≤–µ–Ω—å_–∑–∞—Å—Ç–æ—è(–æ—Ç–≤–µ—Ç—ã: list) -> int:
    """–†–∞—Å—Å—á–∏—Ç—ã–≤–∞–µ—Ç —É—Ä–æ–≤–µ–Ω—å —Å–∏—Å—Ç–µ–º–Ω–æ–≥–æ –∑–∞—Å—Ç–æ—è"""
    if not –æ—Ç–≤–µ—Ç—ã or len(–æ—Ç–≤–µ—Ç—ã) < 3:
        return 65
    
    —Ç–µ–∫—Å—Ç = ' '.join(–æ—Ç–≤–µ—Ç—ã[:5]).lower()
    
    –º–∞—Ä–∫–µ—Ä—ã_–∑–∞—Å—Ç–æ—è = [
        r'–Ω–µ\s+–º–æ–≥—É', r'–Ω–µ\s+–ø–æ–ª—É—á–∞–µ—Ç—Å—è', r'–Ω–µ\s+–∑–Ω–∞—é', 
        r'–∑–∞—Å—Ç—Ä—è[–ª–Ω][–∞–æ–∏]?', r'–±—É–∫—Å—É—é', r'—Å—Ç–æ—é\s+–Ω–∞\s+–º–µ—Å—Ç–µ',
        r'–±–æ—é—Å—å', r'—Å—Ç—Ä–∞—à–Ω–æ', r'—Å–æ–º–Ω–µ–≤–∞—é—Å—å', r'–∞\s+–≤–¥—Ä—É–≥',
        r'–¥–æ–ª–∂–µ–Ω', r'–Ω–∞–¥–æ', r'–æ–±—è–∑–∞–Ω', r'–≤—ã–Ω—É–∂–¥–µ–Ω',
        r'–ø—Ä–æ–±–ª–µ–º[–∞—ã—É–µ]', r'—Ç—Ä—É–¥–Ω–æ—Å—Ç[–∏—å]', r'–ø—Ä–µ–ø—è—Ç—Å—Ç–≤–∏[–µ—è]',
        r'–Ω–µ–≤–æ–∑–º–æ–∂–Ω', r'—Å–ª–æ–∂–Ω', r'—Ç—è–∂–µ–ª'
    ]
    
    –º–∞—Ä–∫–µ—Ä—ã_–¥–≤–∏–∂–µ–Ω–∏—è = [
        r'–º–æ–≥—É', r'—Ö–æ—á—É', r'–±—É–¥—É', r'—Å–¥–µ–ª–∞—é',
        r'—Ä–µ—à–∞—é', r'–≤—ã–±–∏—Ä–∞—é', r'—Å–æ–∑–¥–∞—é',
        r'–≤–µ—Ä—é', r'–¥–æ–≤–µ—Ä—è—é', r'—á—É–≤—Å—Ç–≤—É—é\s+—Å–∏–ª—É',
        r'–ª–µ–≥–∫–æ', r'—Å–≤–æ–±–æ–¥–Ω–æ', r'—è—Å–Ω–æ', r'–ø—Ä–æ—Å—Ç–æ',
        r'–∏–Ω—Ç–µ—Ä–µ—Å–Ω', r'—Ä–∞–¥–æ—Å—Ç–Ω', r'—É–≤–µ—Ä–µ–Ω'
    ]
    
    —Å—á–µ—Ç—á–∏–∫_–∑–∞—Å—Ç–æ—è = 0
    —Å—á–µ—Ç—á–∏–∫_–¥–≤–∏–∂–µ–Ω–∏—è = 0
    
    for –º–∞—Ä–∫–µ—Ä in –º–∞—Ä–∫–µ—Ä—ã_–∑–∞—Å—Ç–æ—è:
        —Å—á–µ—Ç—á–∏–∫_–∑–∞—Å—Ç–æ—è += len(re.findall(–º–∞—Ä–∫–µ—Ä, —Ç–µ–∫—Å—Ç))
    
    for –º–∞—Ä–∫–µ—Ä in –º–∞—Ä–∫–µ—Ä—ã_–¥–≤–∏–∂–µ–Ω–∏—è:
        —Å—á–µ—Ç—á–∏–∫_–¥–≤–∏–∂–µ–Ω–∏—è += len(re.findall(–º–∞—Ä–∫–µ—Ä, —Ç–µ–∫—Å—Ç))
    
    –≤—Å–µ–≥–æ = —Å—á–µ—Ç—á–∏–∫_–∑–∞—Å—Ç–æ—è + —Å—á–µ—Ç—á–∏–∫_–¥–≤–∏–∂–µ–Ω–∏—è + 1
    –ø—Ä–æ—Ü–µ–Ω—Ç_–∑–∞—Å—Ç–æ—è = (—Å—á–µ—Ç—á–∏–∫_–∑–∞—Å—Ç–æ—è / –≤—Å–µ–≥–æ) * 100
    
    —É—Ä–æ–≤–µ–Ω—å = min(90, max(30, int(–ø—Ä–æ—Ü–µ–Ω—Ç_–∑–∞—Å—Ç–æ—è)))
    
    # –ö–æ—Ä—Ä–µ–∫—Ç–∏—Ä–æ–≤–∫–∞ –Ω–∞ –æ—Å–Ω–æ–≤–µ –¥–ª–∏–Ω—ã –æ—Ç–≤–µ—Ç–æ–≤
    —Å—Ä–µ–¥–Ω—è—è_–¥–ª–∏–Ω–∞ = sum(len(–æ) for –æ in –æ—Ç–≤–µ—Ç—ã[:3]) / 3 if len(–æ—Ç–≤–µ—Ç—ã) >= 3 else 50
    if —Å—Ä–µ–¥–Ω—è—è_–¥–ª–∏–Ω–∞ < 20:
        —É—Ä–æ–≤–µ–Ω—å = min(90, —É—Ä–æ–≤–µ–Ω—å + 10)
    elif —Å—Ä–µ–¥–Ω—è—è_–¥–ª–∏–Ω–∞ > 100:
        —É—Ä–æ–≤–µ–Ω—å = max(30, —É—Ä–æ–≤–µ–Ω—å - 5)
    
    return —É—Ä–æ–≤–µ–Ω—å

def —Å–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞—Ç—å_–º–µ—Ç–∞—Ñ–æ—Ä–º—É–ª—É(—Ç–µ–∫—Å—Ç_–≤–æ–ø—Ä–æ—Å–∞5: str, —Å–∏–Ω—Ç–µ–∑–∏—Ä–æ–≤–∞–Ω–Ω–∞—è_—Ä–æ–ª—å: str) -> str:
    """–ì–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç –º–µ—Ç–∞—Ñ–æ—Ä–º—É–ª—É —Å –±–ª–æ–∫–æ–º –æ –ª–æ–∂–Ω–æ–º —Å–∏–≥–Ω–∞–ª–µ"""
    —Å–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π_–º–∞—Ä–∫–µ—Ä = –∏–∑–≤–ª–µ—á—å_—Å–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π_–º–∞—Ä–∫–µ—Ä(—Ç–µ–∫—Å—Ç_–≤–æ–ø—Ä–æ—Å–∞5)
    
    if not —Å–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π_–º–∞—Ä–∫–µ—Ä[0].isupper():
        —Å–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π_–º–∞—Ä–∫–µ—Ä = —Å–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π_–º–∞—Ä–∫–µ—Ä[0].upper() + —Å–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π_–º–∞—Ä–∫–µ—Ä[1:]
    
    return f"–Ø –ê–≤—Ç–æ—Ä. –ü–†–ò–ó–ù–ê–Æ {—Å–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π_–º–∞—Ä–∫–µ—Ä} ‚Äî —ç—Ç–æ –ª–æ–∂–Ω—ã–π —Å–∏–≥–Ω–∞–ª –º–æ–µ–≥–æ –º–æ–∑–≥–∞. –ò –í–´–ë–ò–†–ê–Æ –±—ã—Ç—å {—Å–∏–Ω—Ç–µ–∑–∏—Ä–æ–≤–∞–Ω–Ω–∞—è_—Ä–æ–ª—å}"

# --- –§–£–ù–ö–¶–ò–Ø –ì–ï–ù–ï–†–ê–¶–ò–ò –§–û–õ–ë–≠–ö –û–¢–ß–ï–¢–ê ---
def —Å–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞—Ç—å_—Ñ–æ–ª–±—ç–∫_–æ—Ç—á–µ—Ç(–æ—Ç–≤–µ—Ç—ã: list) -> str:
    """–ì–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç —Ñ–æ–ª–±—ç–∫ –æ—Ç—á–µ—Ç –ø–æ –Ω–æ–≤–æ–π —Å—Ç—Ä—É–∫—Ç—É—Ä–µ"""
    if len(–æ—Ç–≤–µ—Ç—ã) < 8:
        –æ—Ç–≤–µ—Ç—ã = –æ—Ç–≤–µ—Ç—ã + [""] * (8 - len(–æ—Ç–≤–µ—Ç—ã))
    
    # –ò–∑–≤–ª–µ–∫–∞–µ–º –¥–∞–Ω–Ω—ã–µ
    –æ–±–ª–∞—Å—Ç—å = –æ—Ç–≤–µ—Ç—ã[0][:50] if –æ—Ç–≤–µ—Ç—ã[0] else "–ù–µ–æ–ø—Ä–µ–¥–µ–ª–µ–Ω–Ω—ã–π –º–æ–¥—É–ª—å"
    —Å–æ—Å—Ç–æ—è–Ω–∏–µ_–≤–æ–ø—Ä–æ—Å–∞2 = —Ñ–∏–ª—å—Ç—Ä–æ–≤–∞—Ç—å_–æ—Ç–≤–µ—Ç_–≤–æ–ø—Ä–æ—Å–∞2(–æ—Ç–≤–µ—Ç—ã[1])
    –∞–Ω–∞–ª–∏–∑_—Ö–æ–ª–æ—Å—Ç–æ–≥–æ_—Ö–æ–¥–∞ = –∞–Ω–∞–ª–∏–∑–∏—Ä–æ–≤–∞—Ç—å_—Ö–æ–ª–æ—Å—Ç–æ–π_—Ö–æ–¥(–æ—Ç–≤–µ—Ç—ã[2])
    –æ–±—Ä–∞–∑_–±–ª–æ–∫–∏—Ä–æ–≤–∫–∏ = –æ—Ç–≤–µ—Ç—ã[3][:50] if –æ—Ç–≤–µ—Ç—ã[3] else "–±–ª–æ–∫–∏—Ä—É—é—â–∏–π –æ–±—ä–µ–∫—Ç"
    —Å–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π_–º–∞—Ä–∫–µ—Ä = –∏–∑–≤–ª–µ—á—å_—Å–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π_–º–∞—Ä–∫–µ—Ä(–æ—Ç–≤–µ—Ç—ã[4])
    —Ç–µ–Ω–µ–≤–æ–π_—Ä–µ—Å—É—Ä—Å = —Ä–∞—Å—à–∏—Ñ—Ä–æ–≤–∞—Ç—å_—Ç–µ–Ω–µ–≤–æ–π_—Ä–µ—Å—É—Ä—Å(–æ—Ç–≤–µ—Ç—ã[5] if len(–æ—Ç–≤–µ—Ç—ã) > 5 else "")
    
    # –°–∏–Ω—Ç–µ–∑–∏—Ä—É–µ–º –ú–µ—Ç–∞-–º–∞—è–∫
    —Å–∏–Ω—Ç–µ–∑–∏—Ä–æ–≤–∞–Ω–Ω–∞—è_—Ä–æ–ª—å = —Å–∏–Ω—Ç–µ–∑–∏—Ä–æ–≤–∞—Ç—å_–º–µ—Ç–∞_–º–∞—è–∫(–æ—Ç–≤–µ—Ç—ã[1], —Ç–µ–Ω–µ–≤–æ–π_—Ä–µ—Å—É—Ä—Å)
    
    # –†–∞—Å—Å—á–∏—Ç—ã–≤–∞–µ–º —É—Ä–æ–≤–µ–Ω—å –∑–∞—Å—Ç–æ—è
    —É—Ä–æ–≤–µ–Ω—å_–∑–∞—Å—Ç–æ—è = —Ä–∞—Å—Å—á–∏—Ç–∞—Ç—å_—É—Ä–æ–≤–µ–Ω—å_–∑–∞—Å—Ç–æ—è(–æ—Ç–≤–µ—Ç—ã)
    
    # –ì–µ–Ω–µ—Ä–∏—Ä—É–µ–º –º–µ—Ç–∞—Ñ–æ—Ä–º—É–ª—É
    –º–µ—Ç–∞—Ñ–æ—Ä–º—É–ª–∞ = —Å–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞—Ç—å_–º–µ—Ç–∞—Ñ–æ—Ä–º—É–ª—É(–æ—Ç–≤–µ—Ç—ã[4], —Å–∏–Ω—Ç–µ–∑–∏—Ä–æ–≤–∞–Ω–Ω–∞—è_—Ä–æ–ª—å)
    
    # –§–æ—Ä–º–∏—Ä—É–µ–º –ø–æ–ª–Ω—ã–π –æ—Ç—á–µ—Ç
    –æ—Ç—á–µ—Ç = f"""‚¨õÔ∏è [–¢–ï–•–ù–ò–ß–ï–°–ö–û–ï –ó–ê–ö–õ–Æ–ß–ï–ù–ò–ï: –î–ò–ê–ì–ù–û–°–¢–ò–ö–ê –ê–í–¢–û–ü–ò–õ–û–¢–ê] üìÄ

–°—Ç–∞—Ç—É—Å: –û–±–Ω–∞—Ä—É–∂–µ–Ω–æ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ —Ç–æ–∫–∞ —ç–Ω–µ—Ä–≥–∏–∏ –≤ —É–∫–∞–∑–∞–Ω–Ω–æ–π –æ–±–ª–∞—Å—Ç–∏.

üìä –£–†–û–í–ï–ù–¨ –°–ò–°–¢–ï–ú–ù–û–ì–û –ó–ê–°–¢–û–Ø: {—É—Ä–æ–≤–µ–Ω—å_–∑–∞—Å—Ç–æ—è}%

üß† –î–ò–ê–ì–ù–û–°–¢–ò–ö–ê –ö–û–ù–¢–£–†–û–í:

–£–ó–ï–õ –°–û–ü–†–û–¢–ò–í–õ–ï–ù–ò–Ø: –û–±—Ä–∞–∑ "{–æ–±—Ä–∞–∑_–±–ª–æ–∫–∏—Ä–æ–≤–∫–∏}" –±–ª–æ–∫–∏—Ä—É–µ—Ç –¥–≤–∏–∂–µ–Ω–∏–µ —Å–∏—Å—Ç–µ–º—ã, –≤—ã–∑—ã–≤–∞—è —Å–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π –º–∞—Ä–∫–µ—Ä {—Å–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π_–º–∞—Ä–∫–µ—Ä}.

–•–û–õ–û–°–¢–û–ô –•–û–î (–î–°–ú - –î–ï–§–û–õ–¢-–°–ò–°–¢–ï–ú–ê –ú–û–ó–ì–ê): {–∞–Ω–∞–ª–∏–∑_—Ö–æ–ª–æ—Å—Ç–æ–≥–æ_—Ö–æ–¥–∞}

–†–ï–ê–ö–¢–û–† –ò–î–ï–ù–¢–ò–ß–ù–û–°–¢–ò (–°–ö–†–´–¢–´–ô –†–ï–°–£–†–°): {—Ç–µ–Ω–µ–≤–æ–π_—Ä–µ—Å—É—Ä—Å}.

–ú–ï–¢–ê-–ú–ê–Ø–ö (–≠–¢–ê–õ–û–ù): {—Å–∏–Ω—Ç–µ–∑–∏—Ä–æ–≤–∞–Ω–Ω–∞—è_—Ä–æ–ª—å}.

‚ö°Ô∏è –ö–û–î –ü–ï–†–ï–ü–†–û–®–ò–í–ö–ò (–ú–ï–¢–ê–§–û–†–ú–£–õ–ê): {–º–µ—Ç–∞—Ñ–æ—Ä–º—É–ª–∞}

[–î–ò–†–ï–ö–¢–ò–í–ê]: –ö–æ–¥ —Å—Ñ–æ—Ä–º–∏—Ä–æ–≤–∞–Ω. –ü–µ—Ä–µ—Ö–æ–¥–∏—Ç–µ –∫ –í–∏–¥–µ–æ-–ø—Ä–∞–∫—Ç–∏–∫—É–º—É –Ω–∏–∂–µ –¥–ª—è –µ–≥–æ –∏–Ω—Å—Ç–∞–ª–ª—è—Ü–∏–∏."""
    
    return –æ—Ç—á–µ—Ç

# --- –§–£–ù–ö–¶–ò–Ø –û–¢–ü–†–ê–í–ö–ò –ü–†–û–¢–û–ö–û–õ–ê ---
async def —Å–∫–∞—á–∞—Ç—å_–∏_–æ—Ç–ø—Ä–∞–≤–∏—Ç—å_–ø—Ä–æ—Ç–æ–∫–æ–ª(—Å–æ–æ–±—â–µ–Ω–∏–µ: types.Message):
    """–°–∫–∞—á–∏–≤–∞–µ—Ç PDF –∏ –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç –µ–≥–æ —Å –æ–±–Ω–æ–≤–ª–µ–Ω–Ω—ã–º –æ–ø–∏—Å–∞–Ω–∏–µ–º"""
    try:
        await —Å–æ–æ–±—â–µ–Ω–∏–µ.answer("üì• **–ó–∞–≥—Ä—É–∂–∞—é –≤–∞—à –ø—Ä–æ—Ç–æ–∫–æ–ª...**", parse_mode="Markdown")
        
        async with ClientSession() as —Å–µ—Å—Å–∏—è:
            async with —Å–µ—Å—Å–∏—è.get(–°–°–´–õ–ö–ê_–ü–†–û–¢–û–ö–û–õ–ê) as –æ—Ç–≤–µ—Ç:
                if –æ—Ç–≤–µ—Ç.status != 200: 
                    raise Exception(f"–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏: {–æ—Ç–≤–µ—Ç.status}")
                –¥–∞–Ω–Ω—ã–µ_pdf = await –æ—Ç–≤–µ—Ç.read()
        
        —Ç–µ–∫—Å—Ç_–ø–æ–¥–ø–∏—Å–∏ = (
            "üìò –ü—Ä–æ—Ç–æ–∫–æ–ª ¬´–î–µ—à–∏—Ñ—Ä–æ–≤–∫–∞ –ê–≤—Ç–æ–ø–∏–ª–æ—Ç–∞¬ª —É—Å–ø–µ—à–Ω–æ –∑–∞–≥—Ä—É–∂–µ–Ω.\n\n"
            "–ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ –ø–µ—Ä–µ–ø—Ä–æ—à–∏–≤–∫–∏:\n"
            "‚Ä¢ –§–∏–∑–∏–∫–∞ —Å–∏—Å—Ç–µ–º–Ω—ã—Ö –∑–∞—Å—Ç–æ–µ–≤\n"
            "‚Ä¢ –¢–µ—Ö–Ω–æ–ª–æ–≥–∏—è –í–Ω–µ—à–Ω–µ–≥–æ –ù–∞–±–ª—é–¥–∞—Ç–µ–ª—è\n"
            "‚Ä¢ –ü—Ä–∏–Ω—Ü–∏–ø –ó–µ—Ä–∫–∞–ª–∞\n"
            "‚Ä¢ –ú–µ—Ö–∞–Ω–∏–∫–∞ –ú–µ—Ç–∞—Ñ–æ—Ä–º—É–ª—ã\n\n"
            "**–ù–∞—á–Ω–∏—Ç–µ –∏–∑—É—á–µ–Ω–∏–µ —Å —Ä–∞–∑–¥–µ–ª–∞ \"–õ–æ–≤—É—à–∫–∞ –∏–Ω—Ç–µ–ª–ª–µ–∫—Ç–∞\" ‚Äî —Ç–∞–º –æ–±—ä—è—Å–Ω–µ–Ω–æ, –ø–æ—á–µ–º—É –≤–∞—à–∏ –∑–Ω–∞–Ω–∏—è –±–µ–∑ –º–∏–µ–ª–∏–Ω–∏–∑–∞—Ü–∏–∏ –Ω–µ –º–µ–Ω—è—é—Ç –±–∏–æ–ª–æ–≥–∏—á–µ—Å–∫—É—é –ø—Ä–æ—à–∏–≤–∫—É –º–æ–∑–≥–∞.**\n\n"
            "–ò–Ω—Å—Ç–∞–ª–ª—è—Ü–∏–æ–Ω–Ω—ã–π –ø–∞–∫–µ—Ç."
        )

        await —Å–æ–æ–±—â–µ–Ω–∏–µ.answer_document(
            document=types.BufferedInputFile(–¥–∞–Ω–Ω—ã–µ_pdf, filename=–ò–ú–Ø_–§–ê–ô–õ–ê_–ü–†–û–¢–û–ö–û–õ–ê),
            caption=—Ç–µ–∫—Å—Ç_–ø–æ–¥–ø–∏—Å–∏,
            parse_mode="Markdown"
        )
        return True
    except Exception as e:
        –ª–æ–≥–≥–µ—Ä.error(f"–û—à–∏–±–∫–∞ PDF: {e}")
        await —Å–æ–æ–±—â–µ–Ω–∏–µ.answer(f"‚ö†Ô∏è –û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ –ø—Ä–æ—Ç–æ–∫–æ–ª–∞. –ü—Ä—è–º–∞—è —Å—Å—ã–ª–∫–∞: {–°–°–´–õ–ö–ê_–ü–†–û–¢–û–ö–û–õ–ê}")
        return False

# --- –§–£–ù–ö–¶–ò–Ø –û–¢–ü–†–ê–í–ö–ò –°–û–û–ë–©–ï–ù–ò–Ø –û –°–î–í–ò–ì–ï ---
async def –æ—Ç–ø—Ä–∞–≤–∏—Ç—å_—Å–æ–æ–±—â–µ–Ω–∏–µ_–æ_—Å–¥–≤–∏–≥–µ_–∫_–º–∫(—Å–æ–æ–±—â–µ–Ω–∏–µ: types.Message):
    """–û—Ç–ø—Ä–∞–≤–ª—è–µ—Ç —Å–æ–æ–±—â–µ–Ω–∏–µ –æ —Å–¥–≤–∏–≥–µ –∫ –º–∞—Å—Ç–µ—Ä-–∫–ª–∞—Å—Å—É —á–µ—Ä–µ–∑ –∑–∞–¥–µ—Ä–∂–∫—É"""
    await asyncio.sleep(30)
    
    try:
        –∫–æ–Ω—Å—Ç—Ä—É–∫—Ç–æ—Ä = InlineKeyboardBuilder()
        –∫–æ–Ω—Å—Ç—Ä—É–∫—Ç–æ—Ä.row(
            types.InlineKeyboardButton(
                text='‚ö°Ô∏è –ò–ù–°–¢–ê–õ–õ–ò–†–û–í–ê–¢–¨ –ö–û–î –ú–ï–¢–ê–§–û–†–ú–£–õ–´ ‚Äî 990 —Ä.',
                url=–°–°–´–õ–ö–ê_–ú–ê–°–¢–ï–†–ö–õ–ê–°–°–ê
            )
        )
        
        —Å–æ–æ–±—â–µ–Ω–∏–µ_–º–∫ = (
            "üéØ –î–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞ –∑–∞–≤–µ—Ä—à–µ–Ω–∞. –ö–æ–¥ –ø–µ—Ä–µ–ø—Ä–æ—à–∏–≤–∫–∏ —Å—Ñ–æ—Ä–º–∏—Ä–æ–≤–∞–Ω.\n\n"
            "–í—ã –ø–æ–ª—É—á–∏–ª–∏ —Å–≤–æ—é –ú–µ—Ç–∞—Ñ–æ—Ä–º—É–ª—É ‚Äî —Å–∏—Å—Ç–µ–º–Ω—ã–π –∫–ª—é—á –¥–ª—è –ø–µ—Ä–µ—Ö–≤–∞—Ç–∞ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è. "
            "–î–ª—è –ø–æ–ª–Ω–æ–π –∏–Ω—Å—Ç–∞–ª–ª—è—Ü–∏–∏ –∫–æ–¥–∞ –∏ –ø–æ–ª—É—á–µ–Ω–∏—è –ê—É–¥–∏–æ-–∫–æ–¥–∞ ¬´–ü–µ—Ä–µ—Ö–≤–∞—Ç—á–∏–∫¬ª, –∞–∫—Ç–∏–≤–∏—Ä—É–π—Ç–µ –ø–∞–∫–µ—Ç:\n\n"
            "‚Ä¢ üé¨ –í–∏–¥–µ–æ-–ø—Ä–∞–∫—Ç–∏–∫—É–º ¬´–ö–û–î –ú–ï–¢–ê–§–û–†–ú–£–õ–´¬ª\n"
            "‚Ä¢ –ê—É–¥–∏–æ-–∫–æ–¥ ¬´–ü–µ—Ä–µ—Ö–≤–∞—Ç—á–∏–∫ –ê–≤—Ç–æ–ø–∏–ª–æ—Ç–∞¬ª\n"
            "‚Ä¢ –ü—Ä–æ—Ç–æ–∫–æ–ª –æ—Ç–ª–∞–¥–∫–∏ (—Ä–∞–±–æ—á–∞—è —Ç–µ—Ç—Ä–∞–¥—å)"
        )
        
        await —Å–æ–æ–±—â–µ–Ω–∏–µ.answer(
            —Å–æ–æ–±—â–µ–Ω–∏–µ_–º–∫,
            parse_mode="Markdown",
            reply_markup=–∫–æ–Ω—Å—Ç—Ä—É–∫—Ç–æ—Ä.as_markup()
        )
        
    except Exception as e:
        –ª–æ–≥–≥–µ—Ä.error(f"–û—à–∏–±–∫–∞ –æ—Ç–ø—Ä–∞–≤–∫–∏ —Å–¥–≤–∏–≥–∞ –∫ –ú–ö: {e}")

# --- –§–£–ù–ö–¶–ò–Ø –ü–†–û–í–ï–†–ö–ò –ü–û–î–ü–ò–°–ö–ò ---
async def –ø—Ä–æ–≤–µ—Ä–∫–∞_–ø–æ–¥–ø–∏—Å–∫–∏(–∏–¥_–ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è: int) -> bool:
    try:
        —É—á–∞—Å—Ç–Ω–∏–∫ = await –±–æ—Ç.get_chat_member(chat_id=–ò–î_–ö–ê–ù–ê–õ–ê, user_id=–∏–¥_–ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è)
        return —É—á–∞—Å—Ç–Ω–∏–∫.status in ["member", "administrator", "creator"]
    except Exception as e:
        –ª–æ–≥–≥–µ—Ä.error(f"–û—à–∏–±–∫–∞ –ø—Ä–æ–≤–µ—Ä–∫–∏ –ø–æ–¥–ø–∏—Å–∫–∏: {e}")
        return False

# --- –°–ò–°–¢–ï–ú–ê –ú–û–ù–ò–¢–û–†–ò–ù–ì–ê ---
async def –æ—Ç–ø—Ä–∞–≤–∏—Ç—å_–∞–ª–µ—Ä—Ç_–∞–¥–º–∏–Ω—É(—Ç–∏–ø_–∞–ª–µ—Ä—Ç–∞: str, –¥–µ—Ç–∞–ª–∏: str, —Ç—Ä–∞—Å—Å–∏—Ä–æ–≤–∫–∞: str = ""):
    global —Å—á–µ—Ç—á–∏–∫_–æ—à–∏–±–æ–∫, —Å–±–æ–∏_api
    try:
        –º–µ—Ç–∫–∞_–≤—Ä–µ–º–µ–Ω–∏ = datetime.now().strftime("%d.%m %H:%M:%S")
        
        —Å–æ–æ–±—â–µ–Ω–∏–µ = f"üö® –°–ò–ì–ù–ê–õ: {—Ç–∏–ø_–∞–ª–µ—Ä—Ç–∞.upper()}\n\n"
        —Å–æ–æ–±—â–µ–Ω–∏–µ += f"‚è∞ –í—Ä–µ–º—è: {–º–µ—Ç–∫–∞_–≤—Ä–µ–º–µ–Ω–∏}\n"
        —Å–æ–æ–±—â–µ–Ω–∏–µ += f"üìù –î–µ—Ç–∞–ª–∏: {–¥–µ—Ç–∞–ª–∏}\n"
        
        if —Ç—Ä–∞—Å—Å–∏—Ä–æ–≤–∫–∞:
            if len(—Ç—Ä–∞—Å—Å–∏—Ä–æ–≤–∫–∞) > 1000:
                —Å–æ–æ–±—â–µ–Ω–∏–µ += f"\nüîß –¢—Ä–∞—Å—Å–∏—Ä–æ–≤–∫–∞: (–æ—Ç–ø—Ä–∞–≤–ª–µ–Ω–∞ –æ—Ç–¥–µ–ª—å–Ω—ã–º —Ñ–∞–π–ª–æ–º)"
                
                await –±–æ—Ç.send_document(
                    chat_id=–ò–î_–ê–î–ú–ò–ù–ê,
                    document=types.BufferedInputFile(
                        —Ç—Ä–∞—Å—Å–∏—Ä–æ–≤–∫–∞.encode('utf-8'),
                        filename=f"—Ç—Ä–∞—Å—Å–∏—Ä–æ–≤–∫–∞_{–º–µ—Ç–∫–∞_–≤—Ä–µ–º–µ–Ω–∏.replace(':', '-').replace(' ', '_')}.txt"
                    ),
                    caption=f"–¢—Ä–∞—Å—Å–∏—Ä–æ–≤–∫–∞ –æ—à–∏–±–∫–∏: {—Ç–∏–ø_–∞–ª–µ—Ä—Ç–∞}"
                )
            else:
                —Å–æ–æ–±—â–µ–Ω–∏–µ += f"\nüîß –¢—Ä–∞—Å—Å–∏—Ä–æ–≤–∫–∞:\n{—Ç—Ä–∞—Å—Å–∏—Ä–æ–≤–∫–∞[:800]}"
        
        —Å–æ–æ–±—â–µ–Ω–∏–µ += f"\n\nüìä –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞: –û—à–∏–±–æ–∫: {—Å—á–µ—Ç—á–∏–∫_–æ—à–∏–±–æ–∫} | –°–±–æ–µ–≤ API: {—Å–±–æ–∏_api}"
        
        await –±ot.send_message(chat_id=–ò–î_–ê–î–ú–ò–ù–ê, text=—Å–æ–æ–±—â–µ–Ω–∏–µ)
    except Exception as e:
        –ª–æ–≥–≥–µ—Ä.error(f"–ù–µ —É–¥–∞–ª–æ—Å—å –æ—Ç–ø—Ä–∞–≤–∏—Ç—å –∞–ª–µ—Ä—Ç: {e}")

async def –æ—Ç–ø—Ä–∞–≤–∏—Ç—å_–∫–æ–ø–∏—é_–∞–¥–º–∏–Ω—É(–ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å: types.User, –æ—Ç–≤–µ—Ç—ã: list, –æ—Ç—á–µ—Ç: str):
    try:
        –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è_–æ_–ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ = f"üë§ {–ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å.full_name} (@{–ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å.username})"
        —Ç–µ–∫—Å—Ç–æ–≤—ã–µ_–æ—Ç–≤–µ—Ç—ã = "\n".join([f"{i+1}. {–æ}" for i, –æ in enumerate(–æ—Ç–≤–µ—Ç—ã)])
        
        –ø–æ–ª–Ω—ã–π_–ª–æ–≥ = (
            "üîî –ù–û–í–ê–Ø –î–ò–ê–ì–ù–û–°–¢–ò–ö–ê –ó–ê–í–ï–†–®–ï–ù–ê\n\n"
            f"{–∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è_–æ_–ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ}\n\n"
            "üìù –û—Ç–≤–µ—Ç—ã –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è:\n"
            f"{—Ç–µ–∫—Å—Ç–æ–≤—ã–µ_–æ—Ç–≤–µ—Ç—ã}\n\n"
            "üß† –û—Ç—á–µ—Ç –ê—Ä—Ö–∏—Ç–µ–∫—Ç–æ—Ä–∞:\n"
            f"{–æ—Ç—á–µ—Ç}"
        )
        
        if len(–ø–æ–ª–Ω—ã–π_–ª–æ–≥) > 4000:
            await –±–æ—Ç.send_message(chat_id=–ò–î_–ê–î–ú–ò–ù–ê, text=–ø–æ–ª–Ω—ã–π_–ª–æ–≥[:4000])
            await –±–æ—Ç.send_message(chat_id=–ò–î_–ê–î–ú–ò–ù–ê, text=–ø–æ–ª–Ω—ã–π_–ª–æ–≥[4000:8000] if len(–ø–æ–ª–Ω—ã–π_–ª–æ–≥) > 8000 else –ø–æ–ª–Ω—ã–π_–ª–æ–≥[4000:])
        else:
            await –±–æ—Ç.send_message(chat_id=–ò–î_–ê–î–ú–ò–ù–ê, text=–ø–æ–ª–Ω—ã–π_–ª–æ–≥)
    except Exception as e:
        –ª–æ–≥–≥–µ—Ä.error(f"–û—à–∏–±–∫–∞ –ª–æ–≥–∞ –∞–¥–º–∏–Ω—É: {e}")

# --- –û–ë–†–ê–ë–û–¢–ß–ò–ö–ò ---
@–¥–∏—Å–ø–µ—Ç—á–µ—Ä.message(Command("start"))
async def –∫–æ–º–∞–Ω–¥–∞_—Å—Ç–∞—Ä—Ç(—Å–æ–æ–±—â–µ–Ω–∏–µ: types.Message, —Å–æ—Å—Ç–æ—è–Ω–∏–µ: FSMContext):
    await —Å–æ—Å—Ç–æ—è–Ω–∏–µ.clear()
    try:
        –ø–æ–¥–ø–∏—Å–∞–Ω = await –ø—Ä–æ–≤–µ—Ä–∫–∞_–ø–æ–¥–ø–∏—Å–∫–∏(—Å–æ–æ–±—â–µ–Ω–∏–µ.from_user.id)
        
        if not –ø–æ–¥–ø–∏—Å–∞–Ω:
            –ø—Ä–∏–≤–µ—Ç—Å—Ç–≤–∏–µ = –ü–†–ò–í–ï–¢–°–¢–í–ò–Ø["–Ω–µ_–ø–æ–¥–ø–∏—Å–∞–Ω"]
            –∫–æ–Ω—Å—Ç—Ä—É–∫—Ç–æ—Ä = InlineKeyboardBuilder()
            –∫–æ–Ω—Å—Ç—Ä—É–∫—Ç–æ—Ä.row(types.InlineKeyboardButton(text="–ü—Ä–∏—Å–æ–µ–¥–∏–Ω–∏—Ç—å—Å—è –∫ –ø—Ä–æ–µ–∫—Ç—É", url=–°–°–´–õ–ö–ê_–ö–ê–ù–ê–õ–ê))
            –∫–æ–Ω—Å—Ç—Ä—É–∫—Ç–æ—Ä.row(types.InlineKeyboardButton(text="–Ø –≤ –∫–∞–Ω–∞–ª–µ! –ù–∞—á–∞—Ç—å –î–∏–∞–≥–Ω–æ—Å—Ç–∏–∫—É", callback_data="–ø—Ä–æ–≤–µ—Ä–∏—Ç—å_–ø–æ–¥–ø–∏—Å–∫—É"))
            
            await —Å–æ–æ–±—â–µ–Ω–∏–µ.answer_photo(
                photo=–ø—Ä–∏–≤–µ—Ç—Å—Ç–≤–∏–µ["–ª–æ–≥–æ"],
                caption=f"**{–ø—Ä–∏–≤–µ—Ç—Å—Ç–≤–∏–µ['–∑–∞–≥–æ–ª–æ–≤–æ–∫']}**\n\n{–ø—Ä–∏–≤–µ—Ç—Å—Ç–≤–∏–µ['—Ç–µ–∫—Å—Ç']}",
                reply_markup=–∫–æ–Ω—Å—Ç—Ä—É–∫—Ç–æ—Ä.as_markup(),
                parse_mode="Markdown"
            )
        else:
            –ø—Ä–∏–≤–µ—Ç—Å—Ç–≤–∏–µ = –ü–†–ò–í–ï–¢–°–¢–í–ò–Ø["–ø–æ–¥–ø–∏—Å–∞–Ω"]
            –∫–æ–Ω—Å—Ç—Ä—É–∫—Ç–æ—Ä = InlineKeyboardBuilder()
            –∫–æ–Ω—Å—Ç—Ä—É–∫—Ç–æ—Ä.row(types.InlineKeyboardButton(text="üöÄ –ó–ê–ü–£–°–¢–ò–¢–¨ –°–ö–ê–ù –ê–í–¢–û–ü–ò–õ–û–¢–ê", callback_data="–Ω–∞—á–∞—Ç—å_–¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫—É"))
            
            await —Å–æ–æ–±—â–µ–Ω–∏–µ.answer_photo(
                photo=–ø—Ä–∏–≤–µ—Ç—Å—Ç–≤–∏–µ["–ª–æ–≥–æ"],
                caption=f"**{–ø—Ä–∏–≤–µ—Ç—Å—Ç–≤–∏–µ['–∑–∞–≥–æ–ª–æ–≤–æ–∫']}**\n\n{–ø—Ä–∏–≤–µ—Ç—Å—Ç–≤–∏–µ['—Ç–µ–∫—Å—Ç']}",
                reply_markup=–∫–æ–Ω—Å—Ç—Ä—É–∫—Ç–æ—Ä.as_markup(),
                parse_mode="Markdown"
            )
            
    except Exception as e:
        –ª–æ–≥–≥–µ—Ä.error(f"–û—à–∏–±–∫–∞ –≤ /start: {e}")
        await –æ—Ç–ø—Ä–∞–≤–∏—Ç—å_–∞–ª–µ—Ä—Ç_–∞–¥–º–∏–Ω—É("—Å—Ç–∞—Ä—Ç_–æ—à–∏–±–∫–∞", str(e), traceback.format_exc())
        await —Å–æ–æ–±—â–µ–Ω–∏–µ.answer("‚ö†Ô∏è –ü—Ä–æ–∏–∑–æ—à–ª–∞ —Ç–µ—Ö–Ω–∏—á–µ—Å–∫–∞—è –æ—à–∏–±–∫–∞. –ü–æ–ø—Ä–æ–±—É–π—Ç–µ –ø–æ–∑–∂–µ.")

@–¥–∏—Å–ø–µ—Ç—á–µ—Ä.callback_query(F.data == "–ø—Ä–æ–≤–µ—Ä–∏—Ç—å_–ø–æ–¥–ø–∏—Å–∫—É")
async def –æ–±—Ä–∞–±–æ—Ç—á–∏–∫_–ø—Ä–æ–≤–µ—Ä–∫–∏_–ø–æ–¥–ø–∏—Å–∫–∏(–∑–∞–ø—Ä–æ—Å: types.CallbackQuery, —Å–æ—Å—Ç–æ—è–Ω–∏–µ: FSMContext):
    await –∑–∞–ø—Ä–æ—Å.answer("–ü—Ä–æ–≤–µ—Ä—è—é –ø–æ–¥–ø–∏—Å–∫—É...")
    try:
        await asyncio.sleep(0.5)
        –ø–æ–¥–ø–∏—Å–∞–Ω = await –ø—Ä–æ–≤–µ—Ä–∫–∞_–ø–æ–¥–ø–∏—Å–∫–∏(–∑–∞–ø—Ä–æ—Å.from_user.id)
        
        if –ø–æ–¥–ø–∏—Å–∞–Ω:
            –ø—Ä–∏–≤–µ—Ç—Å—Ç–≤–∏–µ = –ü–†–ò–í–ï–¢–°–¢–í–ò–Ø["–ø–æ–¥–ø–∏—Å–∞–Ω"]
            –∫–æ–Ω—Å—Ç—Ä—É–∫—Ç–æ—Ä = InlineKeyboardBuilder()
            –∫–æ–Ω—Å—Ç—Ä—É–∫—Ç–æ—Ä.row(types.InlineKeyboardButton(text="üöÄ –ó–ê–ü–£–°–¢–ò–¢–¨ –°–ö–ê–ù –ê–í–¢–û–ü–ò–õ–û–¢–ê", callback_data="–Ω–∞—á–∞—Ç—å_–¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫—É"))
            
            try:
                await –∑–∞–ø—Ä–æ—Å.message.edit_media(
                    media=types.InputMediaPhoto(
                        media=–ø—Ä–∏–≤–µ—Ç—Å—Ç–≤–∏–µ["–ª–æ–≥–æ"],
                        caption=f"**{–ø—Ä–∏–≤–µ—Ç—Å—Ç–≤–∏–µ['–∑–∞–≥–æ–ª–æ–≤–æ–∫']}**\n\n{–ø—Ä–∏–≤–µ—Ç—Å—Ç–≤–∏–µ['—Ç–µ–∫—Å—Ç']}",
                        parse_mode="Markdown"
                    ),
                    reply_markup=–∫–æ–Ω—Å—Ç—Ä—É–∫—Ç–æ—Ä.as_markup()
                )
            except:
                await –∑–∞–ø—Ä–æ—Å.message.answer_photo(
                    photo=–ø—Ä–∏–≤–µ—Ç—Å—Ç–≤–∏–µ["–ª–æ–≥–æ"],
                    caption=f"**{–ø—Ä–∏–≤–µ—Ç—Å—Ç–≤–∏–µ['–∑–∞–≥–æ–ª–æ–≤–æ–∫']}**\n\n{–ø—Ä–∏–≤–µ—Ç—Å—Ç–≤–∏–µ['—Ç–µ–∫—Å—Ç']}",
                    reply_markup=–∫–æ–Ω—Å—Ç—Ä—É–∫—Ç–æ—Ä.as_markup(),
                    parse_mode="Markdown"
                )
        else:
            –∫–æ–Ω—Å—Ç—Ä—É–∫—Ç–æ—Ä = InlineKeyboardBuilder()
            –∫–æ–Ω—Å—Ç—Ä—É–∫—Ç–æ—Ä.row(types.InlineKeyboardButton(text="üì¢ –ü–æ–¥–ø–∏—Å–∞—Ç—å—Å—è –Ω–∞ –∫–∞–Ω–∞–ª", url=–°–°–´–õ–ö–ê_–ö–ê–ù–ê–õ–ê))
            –∫–æ–Ω—Å—Ç—Ä—É–∫—Ç–æ—Ä.row(types.InlineKeyboardButton(text="‚úÖ –Ø —É–∂–µ –ø–æ–¥–ø–∏—Å–∞–ª—Å—è", callback_data="–ø—Ä–æ–≤–µ—Ä–∏—Ç—å_–ø–æ–¥–ø–∏—Å–∫—É_—Å–Ω–æ–≤–∞"))
            
            await –∑–∞–ø—Ä–æ—Å.message.answer(
                "‚ùå **–í—ã –µ—â–µ –Ω–µ –ø–æ–¥–ø–∏—Å–∞–Ω—ã –Ω–∞ –∫–∞–Ω–∞–ª!**\n\n–î–ª—è –¥–æ—Å—Ç—É–ø–∞ –∫ –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–µ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ –ø–æ–¥–ø–∏—Å–∞—Ç—å—Å—è.",
                reply_markup=–∫–æ–Ω—Å—Ç—Ä—É–∫—Ç–æ—Ä.as_markup(),
                parse_mode="Markdown"
            )
            await –∑–∞–ø—Ä–æ—Å.answer("–í—ã –µ—â–µ –Ω–µ –ø–æ–¥–ø–∏—Å–∞–Ω—ã!", show_alert=True)
                
    except Exception as e:
        –ª–æ–≥–≥–µ—Ä.error(f"–û—à–∏–±–∫–∞ –ø—Ä–æ–≤–µ—Ä–∫–∏ –ø–æ–¥–ø–∏—Å–∫–∏: {e}")
        await –∑–∞–ø—Ä–æ—Å.answer("–û—à–∏–±–∫–∞ –ø—Ä–∏ –ø—Ä–æ–≤–µ—Ä–∫–µ –ø–æ–¥–ø–∏—Å–∫–∏", show_alert=True)

@–¥–∏—Å–ø–µ—Ç—á–µ—Ä.callback_query(F.data == "–ø—Ä–æ–≤–µ—Ä–∏—Ç—å_–ø–æ–¥–ø–∏—Å–∫—É_—Å–Ω–æ–≤–∞")
async def –æ–±—Ä–∞–±–æ—Ç—á–∏–∫_–ø–æ–≤—Ç–æ—Ä–Ω–æ–π_–ø—Ä–æ–≤–µ—Ä–∫–∏(–∑–∞–ø—Ä–æ—Å: types.CallbackQuery):
    await –∑–∞–ø—Ä–æ—Å.answer("–ü—Ä–æ–≤–µ—Ä—è—é –µ—â–µ —Ä–∞–∑...")
    try:
        –ø–æ–¥–ø–∏—Å–∞–Ω = await –ø—Ä–æ–≤–µ—Ä–∫–∞_–ø–æ–¥–ø–∏—Å–∫–∏(–∑–∞–ø—Ä–æ—Å.from_user.id)
        
        if –ø–æ–¥–ø–∏—Å–∞–Ω:
            –ø—Ä–∏–≤–µ—Ç—Å—Ç–≤–∏–µ = –ü–†–ò–í–ï–¢–°–¢–í–ò–Ø["–ø–æ–¥–ø–∏—Å–∞–Ω"]
            –∫–æ–Ω—Å—Ç—Ä—É–∫—Ç–æ—Ä = InlineKeyboardBuilder()
            –∫–æ–Ω—Å—Ç—Ä—É–∫—Ç–æ—Ä.row(types.InlineKeyboardButton(text="üöÄ –ó–ê–ü–£–°–¢–ò–¢–¨ –°–ö–ê–ù –ê–í–¢–û–ü–ò–õ–û–¢–ê", callback_data="–Ω–∞—á–∞—Ç—å_–¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫—É"))
            
            try:
                await –∑–∞–ø—Ä–æ—Å.message.delete()
            except:
                pass
                
            await –∑–∞–ø—Ä–æ—Å.message.answer_photo(
                photo=–ø—Ä–∏–≤–µ—Ç—Å—Ç–≤–∏–µ["–ª–æ–≥–æ"],
                caption=f"**{–ø—Ä–∏–≤–µ—Ç—Å—Ç–≤–∏–µ['–∑–∞–≥–æ–ª–æ–≤–æ–∫']}**\n\n{–ø—Ä–∏–≤–µ—Ç—Å—Ç–≤–∏–µ['—Ç–µ–∫—Å—Ç']}",
                reply_markup=–∫–æ–Ω—Å—Ç—Ä—É–∫—Ç–æ—Ä.as_markup(),
                parse_mode="Markdown"
            )
        else:
            await –∑–∞–ø—Ä–æ—Å.answer("‚ùå –í—ã –≤—Å–µ –µ—â–µ –Ω–µ –ø–æ–¥–ø–∏—Å–∞–Ω—ã!", show_alert=True)
            
    except Exception as e:
        –ª–æ–≥–≥–µ—Ä.error(f"–û—à–∏–±–∫–∞ –ø–æ–≤—Ç–æ—Ä–Ω–æ–π –ø—Ä–æ–≤–µ—Ä–∫–∏: {e}")
        await –∑–∞–ø—Ä–æ—Å.answer("–û—à–∏–±–∫–∞ –ø—Ä–æ–≤–µ—Ä–∫–∏", show_alert=True)

@–¥–∏—Å–ø–µ—Ç—á–µ—Ä.callback_query(F.data == "–Ω–∞—á–∞—Ç—å_–¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫—É")
async def –∑–∞–ø—É—Å—Ç–∏—Ç—å_–ø–æ—Ç–æ–∫_–¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∏(–∑–∞–ø—Ä–æ—Å: types.CallbackQuery, —Å–æ—Å—Ç–æ—è–Ω–∏–µ: FSMContext):
    await –∑–∞–ø—Ä–æ—Å.answer("–ó–∞–ø—É—Å–∫–∞—é —Å–∫–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ...")
    try:
        if not await –ø—Ä–æ–≤–µ—Ä–∫–∞_–ø–æ–¥–ø–∏—Å–∫–∏(–∑–∞–ø—Ä–æ—Å.from_user.id):
            await –∑–∞–ø—Ä–æ—Å.answer("‚ùå –í—ã –æ—Ç–ø–∏—Å–∞–ª–∏—Å—å –æ—Ç –∫–∞–Ω–∞–ª–∞!", show_alert=True)
            return
        
        await —Å–æ—Å—Ç–æ—è–Ω–∏–µ.update_data(current_step=0, answers=[])
        
        await –∑–∞–ø—Ä–æ—Å.message.answer(
            "üî¨ **–ó–ê–ü–£–°–ö –ü–†–û–¢–û–ö–û–õ–ê –°–ö–ê–ù–ò–†–û–í–ê–ù–ò–Ø –ê–í–¢–û–ü–ò–õ–û–¢–ê**\n\n"
            "–ê–Ω–∞–ª–∏–∑–∏—Ä—É—é 8 —Ç–æ—á–µ–∫ —Ç–µ—Ö–Ω–∏—á–µ—Å–∫–æ–π —Å–ø–µ—Ü–∏—Ñ–∏–∫–∞—Ü–∏–∏:\n"
            "1. –õ–æ–∫–∞—Ü–∏—è —Å–∏—Å—Ç–µ–º–Ω–æ–π –æ—à–∏–±–∫–∏\n"
            "2. –°–ø–µ—Ü–∏—Ñ–∏–∫–∞—Ü–∏–∏ –ú–µ—Ç–∞-–º–∞—è–∫–∞\n"
            "3. –•–æ–ª–æ—Å—Ç–æ–π —Ö–æ–¥ –ø—Ä–æ—Ü–µ—Å—Å–æ—Ä–∞ (–î–°–ú)\n"
            "4. –û–±—Ä–∞–∑ –±–ª–æ–∫–∏—Ä—É—é—â–µ–≥–æ –∫–æ–Ω—Ç—É—Ä–∞\n"
            "5. –ë–∏–æ–ª–æ–≥–∏—á–µ—Å–∫–∏–π –¥–∞—Ç—á–∏–∫\n"
            "6. –°–∫–∞–Ω —Ç–µ–Ω–µ–≤–æ–≥–æ —Ä–µ—Å—É—Ä—Å–∞\n"
            "7. –¶–µ–Ω–∞ –≥—Ä–∞–≤–∏—Ç–∞—Ü–∏–∏ —ç–Ω—Ç—Ä–æ–ø–∏–∏\n"
            "8. –ö–æ–º–∞–Ω–¥–∞ –Ω–∞ –ø–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∫—É\n\n"
            "–û—Ç–≤–µ—á–∞–π—Ç–µ —Ç–æ—á–Ω–æ ‚Äî —ç—Ç–æ —Ñ–æ—Ä–º–∏—Ä—É–µ—Ç –≤–∞—à —É–Ω–∏–∫–∞–ª—å–Ω—ã–π –ö–æ–¥ –ø–µ—Ä–µ–ø—Ä–æ—à–∏–≤–∫–∏.",
            parse_mode="Markdown"
        )
        
        await asyncio.sleep(1)
        await –∑–∞–ø—Ä–æ—Å.message.answer(f"üìç –¢–æ—á–∫–∞ 1 –∏–∑ {len(–í–û–ü–†–û–°–´)}:\n\n{–í–û–ü–†–û–°–´[0]}")
        await —Å–æ—Å—Ç–æ—è–Ω–∏–µ.set_state(–°–æ—Å—Ç–æ—è–Ω–∏–µ–ê—É–¥–∏—Ç–∞.–æ—Ç–≤–µ—Ç—ã_–Ω–∞_–≤–æ–ø—Ä–æ—Å—ã)
        
    except Exception as e:
        –ª–æ–≥–≥–µ—Ä.error(f"–û—à–∏–±–∫–∞ –∑–∞–ø—É—Å–∫–∞ –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∏: {e}")
        await –æ—Ç–ø—Ä–∞–≤–∏—Ç—å_–∞–ª–µ—Ä—Ç_–∞–¥–º–∏–Ω—É("–æ—à–∏–±–∫–∞_–∑–∞–ø—É—Å–∫–∞_–¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∏", str(e), traceback.format_exc())
        await –∑–∞–ø—Ä–æ—Å.message.answer("‚ö†Ô∏è –û—à–∏–±–∫–∞ –∑–∞–ø—É—Å–∫–∞ —Å–∫–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏—è. –ü–æ–ø—Ä–æ–±—É–π—Ç–µ —Å–Ω–æ–≤–∞.")

# --- –§–£–ù–ö–¶–ò–Ø –î–õ–Ø –ù–ï–ú–ï–î–õ–ï–ù–ù–û–ô –û–¢–ü–†–ê–í–ö–ò –ö–ù–û–ü–û–ö ---
async def –æ—Ç–ø—Ä–∞–≤–∏—Ç—å_–Ω–µ–º–µ–¥–ª–µ–Ω–Ω—ã–µ_–∫–Ω–æ–ø–∫–∏_–º–∞—Å—Ç–µ—Ä–∫–ª–∞—Å—Å–∞(—Å–æ–æ–±—â–µ–Ω–∏–µ: types.Message):
    """–û—Ç–ø—Ä–∞–≤–ª—è–µ—Ç –∫–Ω–æ–ø–∫–∏ –¥–ª—è –º–∞—Å—Ç–µ—Ä-–∫–ª–∞—Å—Å–∞ —Å—Ä–∞–∑—É –ø–æ—Å–ª–µ –ø—Ä–æ—Ç–æ–∫–æ–ª–∞"""
    try:
        –∫–æ–Ω—Å—Ç—Ä—É–∫—Ç–æ—Ä = InlineKeyboardBuilder()
        
        –∫–æ–Ω—Å—Ç—Ä—É–∫—Ç–æ—Ä.row(
            types.InlineKeyboardButton(
                text='‚ö°Ô∏è –ò–ù–°–¢–ê–õ–õ–ò–†–û–í–ê–¢–¨ –ö–û–î –ú–ï–¢–ê–§–û–†–ú–£–õ–´ ‚Äî 990 —Ä.', 
                url=–°–°–´–õ–ö–ê_–ú–ê–°–¢–ï–†–ö–õ–ê–°–°–ê
            )
        )
        
        –∫–æ–Ω—Å—Ç—Ä—É–∫—Ç–æ—Ä.row(
            types.InlineKeyboardButton(
                text='üì• –ï–©–ï –†–ê–ó –°–ö–ê–ß–ê–¢–¨ –ü–†–û–¢–û–ö–û–õ',
                callback_data="—Å–∫–∞—á–∞—Ç—å_–ø—Ä–æ—Ç–æ–∫–æ–ª_–≤—Ä—É—á–Ω—É—é"
            )
        )
        
        await —Å–æ–æ–±—â–µ–Ω–∏–µ.answer(
            "üéØ **–í–∞—à–µ —Å–∫–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ –∑–∞–≤–µ—Ä—à–µ–Ω–æ! –ö–æ–¥ –ø–µ—Ä–µ–ø—Ä–æ—à–∏–≤–∫–∏ —Å—Ñ–æ—Ä–º–∏—Ä–æ–≤–∞–Ω.**\n\n"
            "–í—ã –ø–æ–ª—É—á–∏–ª–∏ —É–Ω–∏–∫–∞–ª—å–Ω—ã–π –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç ‚Äî –ø–µ—Ä—Å–æ–Ω–∞–ª—å–Ω—É—é –ú–µ—Ç–∞—Ñ–æ—Ä–º—É–ª—É. "
            "–≠—Ç–æ –∫–ª—é—á –∫ –ø–µ—Ä–µ–ø—Ä–æ—à–∏–≤–∫–µ –≤–∞—à–µ–≥–æ –ê–≤—Ç–æ–ø–∏–ª–æ—Ç–∞.\n\n"
            "–î–ª—è –ø–æ–ª–Ω–æ–≥–æ –ø–æ–≥—Ä—É–∂–µ–Ω–∏—è –≤ –º–µ—Ç–æ–¥–∏–∫—É –ø–æ–ª—É—á–∏—Ç–µ –≤–∏–¥–µ–æ-–ø—Ä–∞–∫—Ç–∏–∫—É–º:",
            parse_mode="Markdown",
            reply_markup=–∫–æ–Ω—Å—Ç—Ä—É–∫—Ç–æ—Ä.as_markup()
        )
    except Exception as e:
        –ª–æ–≥–≥–µ—Ä.error(f"–û—à–∏–±–∫–∞ –æ—Ç–ø—Ä–∞–≤–∫–∏ –∫–Ω–æ–ø–æ–∫: {e}")
        try:
            await —Å–æ–æ–±—â–µ–Ω–∏–µ.answer(
                "üéØ –í–∞—à–µ —Å–∫–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ –∑–∞–≤–µ—Ä—à–µ–Ω–æ! –ö–æ–¥ –ø–µ—Ä–µ–ø—Ä–æ—à–∏–≤–∫–∏ —Å—Ñ–æ—Ä–º–∏—Ä–æ–≤–∞–Ω.\n\n"
                "–î–ª—è –ø–æ–ª–Ω–æ–≥–æ –ø–æ–≥—Ä—É–∂–µ–Ω–∏—è –≤ –º–µ—Ç–æ–¥–∏–∫—É –ø–æ–ª—É—á–∏—Ç–µ –≤–∏–¥–µ–æ-–ø—Ä–∞–∫—Ç–∏–∫—É–º:\n"
                f"{–°–°–´–õ–ö–ê_–ú–ê–°–¢–ï–†–ö–õ–ê–°–°–ê}"
            )
        except:
            pass

@–¥–∏—Å–ø–µ—Ç—á–µ—Ä.callback_query(F.data == "—Å–∫–∞—á–∞—Ç—å_–ø—Ä–æ—Ç–æ–∫–æ–ª_–≤—Ä—É—á–Ω—É—é")
async def –æ–±—Ä–∞–±–æ—Ç—á–∏–∫_—Ä—É—á–Ω–æ–≥–æ_—Å–∫–∞—á–∏–≤–∞–Ω–∏—è(–∑–∞–ø—Ä–æ—Å: types.CallbackQuery):
    """–û–±—Ä–∞–±–æ—Ç—á–∏–∫ —Ä—É—á–Ω–æ–≥–æ —Å–∫–∞—á–∏–≤–∞–Ω–∏—è –ø—Ä–æ—Ç–æ–∫–æ–ª–∞"""
    await –∑–∞–ø—Ä–æ—Å.answer("–ó–∞–≥—Ä—É–∂–∞—é –ø—Ä–æ—Ç–æ–∫–æ–ª...")
    
    try:
        await —Å–∫–∞—á–∞—Ç—å_–∏_–æ—Ç–ø—Ä–∞–≤–∏—Ç—å_–ø—Ä–æ—Ç–æ–∫–æ–ª(–∑–∞–ø—Ä–æ—Å.message)
    except Exception as e:
        –ª–æ–≥–≥–µ—Ä.error(f"–û—à–∏–±–∫–∞ —Ä—É—á–Ω–æ–≥–æ —Å–∫–∞—á–∏–≤–∞–Ω–∏—è: {e}")
        await –∑–∞–ø—Ä–æ—Å.answer("–û—à–∏–±–∫–∞ –ø—Ä–∏ –æ—Ç–ø—Ä–∞–≤–∫–µ –ø—Ä–æ—Ç–æ–∫–æ–ª–∞", show_alert=True)
        await –∑–∞–ø—Ä–æ—Å.message.answer(f"üì• –ü—Ä—è–º–∞—è —Å—Å—ã–ª–∫–∞ –Ω–∞ –ø—Ä–æ—Ç–æ–∫–æ–ª:\n{–°–°–´–õ–ö–ê_–ü–†–û–¢–û–ö–û–õ–ê}")

# --- –û–°–ù–û–í–ù–ê–Ø –§–£–ù–ö–¶–ò–Ø –û–ë–†–ê–ë–û–¢–ö–ò –û–¢–í–ï–¢–û–í ---
@–¥–∏—Å–ø–µ—Ç—á–µ—Ä.message(–°–æ—Å—Ç–æ—è–Ω–∏–µ–ê—É–¥–∏—Ç–∞.–æ—Ç–≤–µ—Ç—ã_–Ω–∞_–≤–æ–ø—Ä–æ—Å—ã)
async def –æ–±—Ä–∞–±–æ—Ç–∞—Ç—å_–æ—Ç–≤–µ—Ç(—Å–æ–æ–±—â–µ–Ω–∏–µ: types.Message, —Å–æ—Å—Ç–æ—è–Ω–∏–µ: FSMContext):
    global —Å—á–µ—Ç—á–∏–∫_–æ—à–∏–±–æ–∫
    
    try:
        if not —Å–æ–æ–±—â–µ–Ω–∏–µ.text or not —Å–æ–æ–±—â–µ–Ω–∏–µ.text.strip():
            return await —Å–æ–æ–±—â–µ–Ω–∏–µ.answer("–ü–æ–∂–∞–ª—É–π—Å—Ç–∞, –Ω–∞–ø–∏—à–∏—Ç–µ —Ç–µ–∫—Å—Ç–æ–≤—ã–π –æ—Ç–≤–µ—Ç.")

        –¥–∞–Ω–Ω—ã–µ = await —Å–æ—Å—Ç–æ—è–Ω–∏–µ.get_data()
        —à–∞–≥ = –¥–∞–Ω–Ω—ã–µ.get("current_step", 0)
        –æ—Ç–≤–µ—Ç—ã_–ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è = –¥–∞–Ω–Ω—ã–µ.get("answers", [])

        –æ—Ç–≤–µ—Ç—ã_–ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è.append(—Å–æ–æ–±—â–µ–Ω–∏–µ.text.strip())
        —Å–ª–µ–¥—É—é—â–∏–π_—à–∞–≥ = —à–∞–≥ + 1

        if —Å–ª–µ–¥—É—é—â–∏–π_—à–∞–≥ < len(–í–û–ü–†–û–°–´):
            await —Å–æ—Å—Ç–æ—è–Ω–∏–µ.update_data(current_step=—Å–ª–µ–¥—É—é—â–∏–π_—à–∞–≥, answers=–æ—Ç–≤–µ—Ç—ã_–ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è)
            await —Å–æ–æ–±—â–µ–Ω–∏–µ.answer(f"üìç –¢–æ—á–∫–∞ {—Å–ª–µ–¥—É—é—â–∏–π_—à–∞–≥ + 1} –∏–∑ {len(–í–û–ü–†–û–°–´)}:\n\n{–í–û–ü–†–û–°–´[—Å–ª–µ–¥—É—é—â–∏–π_—à–∞–≥]}")
        else:
            # –§–ò–ù–ê–õ - –ö–û–ì–ù–ò–¢–ò–í–ù–ê–Ø –ó–ê–ì–õ–£–®–ö–ê + –û–¢–ß–ï–¢ + –ü–†–û–¢–û–ö–û–õ
            await —Å–æ—Å—Ç–æ—è–Ω–∏–µ.update_data(answers=–æ—Ç–≤–µ—Ç—ã_–ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è)
            
            # –ö–û–ì–ù–ò–¢–ò–í–ù–ê–Ø –ó–ê–ì–õ–£–®–ö–ê (Progress Bar)
            await —Å–æ–æ–±—â–µ–Ω–∏–µ.answer("üß† –ò–¥–µ—Ç –¥–µ—à–∏—Ñ—Ä–æ–≤–∫–∞ –≤–∞—à–µ–≥–æ –ö–æ–Ω–Ω–µ–∫—Ç–æ–º–∞... [||||||||||] 60%")
            await asyncio.sleep(2)
            await —Å–æ–æ–±—â–µ–Ω–∏–µ.answer("üß¨ –°–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∏—Ä—É—é –ú–µ—Ç–∞-–ú–∞—è–∫ —Å –±–∏–æ–ª–æ–≥–∏—á–µ—Å–∫–æ–π –ø—Ä–æ—à–∏–≤–∫–æ–π... [||||||||||] 100%")
            
            try:
                –æ—Ç—á–µ—Ç = await —Å–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞—Ç—å_–æ—Ç—á–µ—Ç_–∏–∏(–æ—Ç–≤–µ—Ç—ã_–ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è)
                —á–∏—Å—Ç—ã–π_–æ—Ç—á–µ—Ç = –æ—á–∏—Å—Ç–∏—Ç—å_–æ—Ç—á–µ—Ç_–¥–ª—è_—Ç–µ–ª–µ–≥—Ä–∞–º–∞(–æ—Ç—á–µ—Ç)
                
                # –û—Ç–ø—Ä–∞–≤–ª—è–µ–º –û–î–ò–ù –æ—Ç—á–µ—Ç
                await —Å–æ–æ–±—â–µ–Ω–∏–µ.answer(—á–∏—Å—Ç—ã–π_–æ—Ç—á–µ—Ç)
                
                # –°–†–ê–ó–£ –æ—Ç–ø—Ä–∞–≤–ª—è–µ–º –ø—Ä–æ—Ç–æ–∫–æ–ª –≤ —á–∞—Ç
                await —Å–∫–∞—á–∞—Ç—å_–∏_–æ—Ç–ø—Ä–∞–≤–∏—Ç—å_–ø—Ä–æ—Ç–æ–∫–æ–ª(—Å–æ–æ–±—â–µ–Ω–∏–µ)
                
                # –û—Ç–ø—Ä–∞–≤–ª—è–µ–º –ø–µ—Ä–≤–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ —Å –∫–Ω–æ–ø–∫–∞–º–∏ (–Ω–µ–º–µ–¥–ª–µ–Ω–Ω–æ)
                await –æ—Ç–ø—Ä–∞–≤–∏—Ç—å_–Ω–µ–º–µ–¥–ª–µ–Ω–Ω—ã–µ_–∫–Ω–æ–ø–∫–∏_–º–∞—Å—Ç–µ—Ä–∫–ª–∞—Å—Å–∞(—Å–æ–æ–±—â–µ–Ω–∏–µ)
                
                # –ó–ê–ü–£–°–ö–ê–ï–ú –ó–ê–î–ê–ß–£ –û–¢–õ–û–ñ–ï–ù–ù–û–ì–û –°–û–û–ë–©–ï–ù–ò–Ø
                asyncio.create_task(–æ—Ç–ø—Ä–∞–≤–∏—Ç—å_—Å–æ–æ–±—â–µ–Ω–∏–µ_–æ_—Å–¥–≤–∏–≥–µ_–∫_–º–∫(—Å–æ–æ–±—â–µ–Ω–∏–µ))
                
                # –û—Ç–ø—Ä–∞–≤–ª—è–µ–º –∫–æ–ø–∏—é –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä—É
                await –æ—Ç–ø—Ä–∞–≤–∏—Ç—å_–∫–æ–ø–∏—é_–∞–¥–º–∏–Ω—É(—Å–æ–æ–±—â–µ–Ω–∏–µ.from_user, –æ—Ç–≤–µ—Ç—ã_–ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è, —á–∏—Å—Ç—ã–π_–æ—Ç—á–µ—Ç)
                
            except Exception as –æ—à–∏–±–∫–∞_–æ—Ç—á–µ—Ç–∞:
                –ª–æ–≥–≥–µ—Ä.error(f"–û—à–∏–±–∫–∞ –ø—Ä–∏ –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ –æ—Ç—á–µ—Ç–∞: {–æ—à–∏–±–∫–∞_–æ—Ç—á–µ—Ç–∞}")
                
                # –§–æ–ª–±—ç–∫ –æ—Ç—á–µ—Ç
                —Ñ–æ–ª–±—ç–∫_–æ—Ç—á–µ—Ç = —Å–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞—Ç—å_—Ñ–æ–ª–±—ç–∫_–æ—Ç—á–µ—Ç(–æ—Ç–≤–µ—Ç—ã_–ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è)
                
                await —Å–æ–æ–±—â–µ–Ω–∏–µ.answer(—Ñ–æ–ª–±—ç–∫_–æ—Ç—á–µ—Ç)
                await —Å–∫–∞—á–∞—Ç—å_–∏_–æ—Ç–ø—Ä–∞–≤–∏—Ç—å_–ø—Ä–æ—Ç–æ–∫–æ–ª(—Å–æ–æ–±—â–µ–Ω–∏–µ)
                await –æ—Ç–ø—Ä–∞–≤–∏—Ç—å_–Ω–µ–º–µ–¥–ª–µ–Ω–Ω—ã–µ_–∫–Ω–æ–ø–∫–∏_–º–∞—Å—Ç–µ—Ä–∫–ª–∞—Å—Å–∞(—Å–æ–æ–±—â–µ–Ω–∏–µ)
                
                # –ó–ê–ü–£–°–ö–ê–ï–ú –ó–ê–î–ê–ß–£ –û–¢–õ–û–ñ–ï–ù–ù–û–ì–û –°–û–û–ë–©–ï–ù–ò–Ø –¥–∞–∂–µ –ø—Ä–∏ –æ—à–∏–±–∫–µ
                asyncio.create_task(–æ—Ç–ø—Ä–∞–≤–∏—Ç—å_—Å–æ–æ–±—â–µ–Ω–∏–µ_–æ_—Å–¥–≤–∏–≥–µ_–∫_–º–∫(—Å–æ–æ–±—â–µ–Ω–∏–µ))
            
            await —Å–æ—Å—Ç–æ—è–Ω–∏–µ.clear()
            
    except Exception as e:
        —Å—á–µ—Ç—á–∏–∫_–æ—à–∏–±–æ–∫ += 1
        –ª–æ–≥–≥–µ—Ä.error(f"–û—à–∏–±–∫–∞ –æ–±—Ä–∞–±–æ—Ç–∫–∏ –æ—Ç–≤–µ—Ç–∞: {e}")
        await –æ—Ç–ø—Ä–∞–≤–∏—Ç—å_–∞–ª–µ—Ä—Ç_–∞–¥–º–∏–Ω—É("–æ—à–∏–±–∫–∞_–æ–±—Ä–∞–±–æ—Ç–∫–∏", str(e), traceback.format_exc())
        await —Å–æ–æ–±—â–µ–Ω–∏–µ.answer(
            "‚ö†Ô∏è –ü—Ä–æ–∏–∑–æ—à–ª–∞ —Ç–µ—Ö–Ω–∏—á–µ—Å–∫–∞—è –æ—à–∏–±–∫–∞ –ø—Ä–∏ –æ–±—Ä–∞–±–æ—Ç–∫–µ –≤–∞—à–µ–≥–æ –æ—Ç–≤–µ—Ç–∞.\n\n"
            "–ü–æ–∂–∞–ª—É–π—Å—Ç–∞, –Ω–∞—á–Ω–∏—Ç–µ —Å–∫–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ –∑–∞–Ω–æ–≤–æ —Å –∫–æ–º–∞–Ω–¥—ã /start"
        )

# --- –ì–ï–ù–ï–†–ê–¶–ò–Ø –û–¢–ß–ï–¢–ê –ò–ò ---
async def —Å–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞—Ç—å_–æ—Ç—á–µ—Ç_–∏–∏(–æ—Ç–≤–µ—Ç—ã: list):
    global —Å–±–æ–∏_api
    
    if not –∫–ª–∏–µ–Ω—Ç:
        # –î–µ–º–æ-—Ä–µ–∂–∏–º –¥–ª—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è
        try:
            return —Å–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞—Ç—å_—Ñ–æ–ª–±—ç–∫_–æ—Ç—á–µ—Ç(–æ—Ç–≤–µ—Ç—ã)
        except Exception as e:
            –ª–æ–≥–≥–µ—Ä.error(f"–û—à–∏–±–∫–∞ –≤ –¥–µ–º–æ-—Ä–µ–∂–∏–º–µ: {e}")
            return —Å–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞—Ç—å_—Ñ–æ–ª–±—ç–∫_–æ—Ç—á–µ—Ç(–æ—Ç–≤–µ—Ç—ã)
    
    # –ü–æ–¥–≥–æ—Ç–∞–≤–ª–∏–≤–∞–µ–º –¥–∞–Ω–Ω—ã–µ –¥–ª—è –ò–ò
    —Ç–µ–∫—Å—Ç_–≤–≤–æ–¥–∞_–ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è = "–û–¢–í–ï–¢–´ –ü–û–õ–¨–ó–û–í–ê–¢–ï–õ–Ø –ù–ê 8 –¢–û–ß–ï–ö –¢–ï–•–ù–ò–ß–ï–°–ö–û–ô –î–ò–ê–ì–ù–û–°–¢–ò–ö–ò:\n\n"
    for i, –æ—Ç–≤–µ—Ç in enumerate(–æ—Ç–≤–µ—Ç—ã):
        —Ç–µ–∫—Å—Ç_–≤–≤–æ–¥–∞_–ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è += f"–¢–û–ß–ö–ê {i+1}: {–í–û–ü–†–û–°–´[i]}\n"
        —Ç–µ–∫—Å—Ç_–≤–≤–æ–¥–∞_–ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è += f"–û–¢–í–ï–¢: {–æ—Ç–≤–µ—Ç}\n\n"
    
    —Ç–µ–∫—Å—Ç_–≤–≤–æ–¥–∞_–ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è += "\n---\n–ü–†–û–í–ï–î–ò –¢–ï–•–ù–ò–ß–ï–°–ö–£–Æ –î–ò–ê–ì–ù–û–°–¢–ò–ö–£ –ê–í–¢–û–ü–ò–õ–û–¢–ê –ò –°–§–û–†–ú–ò–†–£–ô –ó–ê–ö–õ–Æ–ß–ï–ù–ò–ï –ü–û –°–¢–†–û–ì–û–ô –°–¢–†–£–ö–¢–£–†–ï. –û–ë–Ø–ó–ê–¢–ï–õ–¨–ù–û –í–ö–õ–Æ–ß–ò –†–ê–ó–î–ï–õ '–•–û–õ–û–°–¢–û–ô –•–û–î (–î–°–ú)' –° –ü–†–ò–ù–¶–ò–ü–û–ú –ë–ò–û–õ–û–ì–ò–ß–ï–°–ö–û–ì–û –ê–õ–ò–ë–ò. –ò–°–ü–û–õ–¨–ó–£–ô –ú–û–ù–¢–û–õ–ò–¢–ù–´–ô –ö–û–î –ú–ï–¢–ê–§–û–†–ú–£–õ–´ –° –ë–õ–û–ö–û–ú –û –õ–û–ñ–ù–û–ú –°–ò–ì–ù–ê–õ–ï. –°–¢–ò–õ–¨: –°–¢–ê–†–®–ò–ô –ê–†–•–ò–¢–ï–ö–¢–û–† –ò–î–ï–ù–¢–ò–ß–ù–û–°–¢–ò. –ë–ï–ó –ü–°–ò–•–û–õ–û–ì–ò–ß–ï–°–ö–ò–• –ö–õ–ò–®–ï."
    
    for –ø–æ–ø—ã—Ç–∫–∞ in range(3):
        try:
            –æ—Ç–≤–µ—Ç_–∏–∏ = await –∫–ª–∏–µ–Ω—Ç.chat.completions.create(
                messages=[
                    {"role": "system", "content": –°–ò–°–¢–ï–ú–ù–´–ô_–ü–†–û–ú–ü–¢},
                    {"role": "user", "content": —Ç–µ–∫—Å—Ç_–≤–≤–æ–¥–∞_–ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è}
                ],
                model="llama-3.3-70b",
                temperature=0.6,
                max_completion_tokens=2000,
                top_p=0.9
            )
            
            —Å–±–æ–∏_api = 0
            
            if hasattr(–æ—Ç–≤–µ—Ç_–∏–∏, 'choices') and len(–æ—Ç–≤–µ—Ç_–∏–∏.choices) > 0:
                –≤—ã–±–æ—Ä = –æ—Ç–≤–µ—Ç_–∏–∏.choices[0]
                if hasattr(–≤—ã–±–æ—Ä, 'message') and hasattr(–≤—ã–±–æ—Ä.message, 'content'):
                    —Å–æ–¥–µ—Ä–∂–∞–Ω–∏–µ = –≤—ã–±–æ—Ä.message.content
                    if —Å–æ–¥–µ—Ä–∂–∞–Ω–∏–µ:
                        return —Å–æ–¥–µ—Ä–∂–∞–Ω–∏–µ
            
            return —Å–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞—Ç—å_—Ñ–æ–ª–±—ç–∫_–æ—Ç—á–µ—Ç(–æ—Ç–≤–µ—Ç—ã)
            
        except Exception as e:
            —Å–±–æ–∏_api += 1
            –ª–æ–≥–≥–µ—Ä.warning(f"–ü–æ–ø—ã—Ç–∫–∞ {–ø–æ–ø—ã—Ç–∫–∞ + 1} –Ω–µ —É–¥–∞–ª–∞—Å—å: {e}")
            
            if –ø–æ–ø—ã—Ç–∫–∞ == 2:
                await –æ—Ç–ø—Ä–∞–≤–∏—Ç—å_–∞–ª–µ—Ä—Ç_–∞–¥–º–∏–Ω—É("–∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏–π_—Å–±–æ–π_api", f"3 –ø–æ–ø—ã—Ç–∫–∏ –ø—Ä–æ–≤–∞–ª–∏–ª–∏—Å—å: {str(e)}")
                return —Å–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞—Ç—å_—Ñ–æ–ª–±—ç–∫_–æ—Ç—á–µ—Ç(–æ—Ç–≤–µ—Ç—ã)
            
            await asyncio.sleep(2 ** –ø–æ–ø—ã—Ç–∫–∞)
    
    return —Å–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞—Ç—å_—Ñ–æ–ª–±—ç–∫_–æ—Ç—á–µ—Ç(–æ—Ç–≤–µ—Ç—ã)

# --- –û–ß–ò–°–¢–ö–ê –û–¢–ß–ï–¢–ê –î–õ–Ø –¢–ï–õ–ï–ì–†–ê–ú–ê ---
def –æ—á–∏—Å—Ç–∏—Ç—å_–æ—Ç—á–µ—Ç_–¥–ª—è_—Ç–µ–ª–µ–≥—Ä–∞–º–∞(–æ—Ç—á–µ—Ç: str) -> str:
    """–ü–æ—Å—Ç–æ–±—Ä–∞–±–æ—Ç–∫–∞ –æ—Ç—á–µ—Ç–∞ –¥–ª—è Telegram –≤ —Å—Ç–∏–ª–µ –°—Ç–∞—Ä—à–µ–≥–æ –ê—Ä—Ö–∏—Ç–µ–∫—Ç–æ—Ä–∞ –ò–¥–µ–Ω—Ç–∏—á–Ω–æ—Å—Ç–∏"""
    try:
        if not –æ—Ç—á–µ—Ç:
            return –æ—Ç—á–µ—Ç
        
        # –£–±–µ–¥–∏–º—Å—è, —á—Ç–æ —Ä–∞–∑–¥–µ–ª –•–û–õ–û–°–¢–û–ô –•–û–î (–î–°–ú) –ø—Ä–∏—Å—É—Ç—Å—Ç–≤—É–µ—Ç
        if "–•–û–õ–û–°–¢–û–ô –•–û–î" not in –æ—Ç—á–µ—Ç.upper() or "–î–°–ú" not in –æ—Ç—á–µ—Ç.upper():
            # –ù–∞–π–¥–µ–º, –≥–¥–µ –º–æ–∂–Ω–æ –≤—Å—Ç–∞–≤–∏—Ç—å —Ä–∞–∑–¥–µ–ª
            —Å—Ç—Ä–æ–∫–∏ = –æ—Ç—á–µ—Ç.split('\n')
            –Ω–æ–≤—ã–µ_—Å—Ç—Ä–æ–∫–∏ = []
            
            for i, —Å—Ç—Ä–æ–∫–∞ in enumerate(—Å—Ç—Ä–æ–∫–∏):
                –Ω–æ–≤—ã–µ_—Å—Ç—Ä–æ–∫–∏.append(—Å—Ç—Ä–æ–∫–∞)
                # –ü–æ—Å–ª–µ "–£–∑–µ–ª —Å–æ–ø—Ä–æ—Ç–∏–≤–ª–µ–Ω–∏—è" –≤—Å—Ç–∞–≤–ª—è–µ–º –•–û–õ–û–°–¢–û–ô –•–û–î (–î–°–ú)
                if "–£–∑–µ–ª —Å–æ–ø—Ä–æ—Ç–∏–≤–ª–µ–Ω–∏—è" in —Å—Ç—Ä–æ–∫–∞ and i + 1 < len(—Å—Ç—Ä–æ–∫–∏):
                    # –ü—Ä–æ–≤–µ—Ä—è–µ–º, –µ—Å—Ç—å –ª–∏ —É–∂–µ —Å–ª–µ–¥—É—é—â–∏–π —Ä–∞–∑–¥–µ–ª
                    —Å–ª–µ–¥—É—é—â–∞—è_—Å—Ç—Ä–æ–∫–∞ = —Å—Ç—Ä–æ–∫–∏[i + 1] if i + 1 < len(—Å—Ç—Ä–æ–∫–∏) else ""
                    if "–•–û–õ–û–°–¢–û–ô –•–û–î" not in —Å–ª–µ–¥—É—é—â–∞—è_—Å—Ç—Ä–æ–∫–∞.upper() and "–†–ï–ê–ö–¢–û–† –ò–î–ï–ù–¢–ò–ß–ù–û–°–¢–ò" not in —Å–ª–µ–¥—É—é—â–∞—è_—Å—Ç—Ä–æ–∫–∞.upper():
                        # –í—Å—Ç–∞–≤–ª—è–µ–º –∑–∞–≥–ª—É—à–∫—É –¥–ª—è —Ö–æ–ª–æ—Å—Ç–æ–≥–æ —Ö–æ–¥–∞ —Å –î–°–ú
                        –Ω–æ–≤—ã–µ_—Å—Ç—Ä–æ–∫–∏.append("\n–•–û–õ–û–°–¢–û–ô –•–û–î (–î–°–ú - –î–ï–§–û–õ–¢-–°–ò–°–¢–ï–ú–ê –ú–û–ó–ì–ê): –î–µ—Ñ–æ–ª—Ç-—Å–∏—Å—Ç–µ–º–∞ –º–æ–∑–≥–∞ (–î–°–ú) –∞–∫—Ç–∏–≤–∏—Ä–æ–≤–∞–Ω–∞. –£—Ç–∏–ª–∏–∑–∞—Ü–∏—è —ç–Ω–µ—Ä–≥–∏–∏: 80%. –≠—Ç–æ —Ä–∞–±–æ—Ç–∞ ¬´–±–∏–æ–ª–æ–≥–∏—á–µ—Å–∫–æ–≥–æ –∞–Ω—Ç–∏–≤–∏—Ä—É—Å–∞¬ª, –∞ –Ω–µ –≤–∞—à–∞ –æ—à–∏–±–∫–∞.")
            
            –æ—Ç—á–µ—Ç = '\n'.join(–Ω–æ–≤—ã–µ_—Å—Ç—Ä–æ–∫–∏)
        
        # –ü–†–ò–ù–£–î–ò–¢–ï–õ–¨–ù–ê–Ø –ó–ê–ú–ï–ù–ê –¢–ï–†–ú–ò–ù–û–í
        –∑–∞–º–µ–Ω—ã = {
            # –£–¥–∞–ª—è–µ–º –∞–Ω–≥–ª–∏—Ü–∏–∑–º—ã –∏ –ø—Å–∏—Ö–æ–ª–æ–≥–∏—á–µ—Å–∫–∏–µ –∫–ª–∏—à–µ
            r'\bHardware\b': '–ë–∏–æ–ª–æ–≥–∏—á–µ—Å–∫–∞—è –ø—Ä–æ—à–∏–≤–∫–∞',
            r'\bDMN\b': '–î–°–ú',
            r'\bDefault Mode Network\b': '–î–µ—Ñ–æ–ª—Ç-—Å–∏—Å—Ç–µ–º–∞ –º–æ–∑–≥–∞',
            r'\bRepatterning\b': '–ù–µ–π—Ä–æ-–ø–µ—Ä–µ–ø—Ä–æ—à–∏–≤–∫–∞',
            r'\bSet-point\b': '–£—Å—Ç–∞–Ω–æ–≤–æ—á–Ω–∞—è —Ç–æ—á–∫–∞',
            r'\bAwareness\b': '–î–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞',
            r'\b–û—Å–æ–∑–Ω–∞–Ω–∏–µ\b': '–î–µ—Ç–µ–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –ø–∞—Ç—Ç–µ—Ä–Ω–∞',
            r'\bVictim\b': '–ü–∞—Å—Å–∞–∂–∏—Ä',
            r'\b–ñ–µ—Ä—Ç–≤–∞\b': '–§—É–Ω–∫—Ü–∏—è',
            
            # –£–¥–∞–ª—è–µ–º —è–∑—ã–∫ –∂–µ—Ä—Ç–≤—ã
            r'–≤—ã —á—É–≤—Å—Ç–≤—É–µ—Ç–µ': '—Å–∏—Å—Ç–µ–º–∞ –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç',
            r'–≤–∞–º –∫–∞–∂–µ—Ç—Å—è': '–∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ —É–∫–∞–∑—ã–≤–∞–µ—Ç',
            r'–≤—ã –ø–æ–Ω–∏–º–∞–µ—Ç–µ': '–¥–∞–Ω–Ω—ã–µ –¥–µ–º–æ–Ω—Å—Ç—Ä–∏—Ä—É—é—Ç',
            r'–≤—ã –æ—Å–æ–∑–Ω–∞–µ—Ç–µ': '–Ω–∞–±–ª—é–¥–∞–µ—Ç—Å—è',
            r'–≤–∞—à–∏ —ç–º–æ—Ü–∏–∏': '—Å–∏–≥–Ω–∞–ª—ã —Å–∏—Å—Ç–µ–º—ã',
            r'—ç–º–æ—Ü–∏–æ–Ω–∞–ª—å–Ω—ã–π': '—Å–∏—Å—Ç–µ–º–Ω—ã–π',
            r'–ø—Å–∏—Ö–æ–ª–æ–≥–∏—á–µ—Å–∫–∏–π': '—Ç–µ—Ö–Ω–∏—á–µ—Å–∫–∏–π',
            r'–ø—Å–∏—Ö–æ–ª–æ–≥–∏—è': '–∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ —Å–∏—Å—Ç–µ–º—ã',
            r'–æ—Å–æ–∑–Ω–∞–Ω–∏–µ': '–¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞',
            r'—á—É–≤—Å—Ç–≤–æ': '—Å–∏–≥–Ω–∞–ª',
            r'—ç–º–æ—Ü–∏—è': '–¥–∞–Ω–Ω—ã–µ',
            r'–≤–∞—à–∞ –ø—Ä–æ–±–ª–µ–º–∞': '—Å–∏—Å—Ç–µ–º–Ω—ã–π —Å–±–æ–π',
            r'–≤–∞—à–∞ —Å–∏—Ç—É–∞—Ü–∏—è': '—Ç–µ–∫—É—â–∞—è –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è',
            
            # –í–Ω–µ–¥—Ä—è–µ–º —Ç–µ—Ö–Ω–∏—á–µ—Å–∫–∏–µ —Ç–µ—Ä–º–∏–Ω—ã
            r'—Å–∏—Å—Ç–µ–º–∞ –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç': '—Å–∏—Å—Ç–µ–º–∞ –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç',
            r'–∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ —É–∫–∞–∑—ã–≤–∞–µ—Ç': '–∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ —É–∫–∞–∑—ã–≤–∞–µ—Ç',
            r'–º–æ–¥—É–ª—å –±–ª–æ–∫–∏—Ä—É–µ—Ç': '–º–æ–¥—É–ª—å –±–ª–æ–∫–∏—Ä—É–µ—Ç',
            r'–ø—Ä–æ—Ü–µ—Å—Å–æ—Ä —É—Ç–∏–ª–∏–∑–∏—Ä—É–µ—Ç': '–ø—Ä–æ—Ü–µ—Å—Å–æ—Ä —É—Ç–∏–ª–∏–∑–∏—Ä—É–µ—Ç',
            r'–î–°–ú –∞–∫—Ç–∏–≤–∏—Ä–æ–≤–∞–Ω': '–î–°–ú –∞–∫—Ç–∏–≤–∏—Ä–æ–≤–∞–Ω',
            r'–î–µ—Ñ–æ–ª—Ç-—Å–∏—Å—Ç–µ–º–∞ –º–æ–∑–≥–∞': '–î–µ—Ñ–æ–ª—Ç-—Å–∏—Å—Ç–µ–º–∞ –º–æ–∑–≥–∞',
            r'–±–∏–æ–ª–æ–≥–∏—á–µ—Å–∫–æ–µ –∞–ª–∏–±–∏': '–±–∏–æ–ª–æ–≥–∏—á–µ—Å–∫–æ–µ –∞–ª–∏–±–∏',
            r'–±–∏–æ–ª–æ–≥–∏—á–µ—Å–∫–∞—è –ø—Ä–æ—à–∏–≤–∫–∞': '–±–∏–æ–ª–æ–≥–∏—á–µ—Å–∫–∞—è –ø—Ä–æ—à–∏–≤–∫–∞',
            r'–Ω–µ–π—Ä–æ–Ω–Ω–∞—è –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞': '–Ω–µ–π—Ä–æ–Ω–Ω–∞—è –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞',
            r'–Ω–µ–π—Ä–æ-–ø–µ—Ä–µ–ø—Ä–æ—à–∏–≤–∫–∞': '–Ω–µ–π—Ä–æ-–ø–µ—Ä–µ–ø—Ä–æ—à–∏–≤–∫–∞',
            r'—É—Å—Ç–∞–Ω–æ–≤–æ—á–Ω–∞—è —Ç–æ—á–∫–∞': '—É—Å—Ç–∞–Ω–æ–≤–æ—á–Ω–∞—è —Ç–æ—á–∫–∞',
            r'–º–∏–µ–ª–∏–Ω–∏–∑–∞—Ü–∏—è': '–º–∏–µ–ª–∏–Ω–∏–∑–∞—Ü–∏—è',
            
            # –§–∏–∫—Å–∏–º –≥—Ä–∞–º–º–∞—Ç–∏–∫—É
            r'—Å—Ç—É–ø–∏—Ç—å –Ω–∞ –ø—Ä–∏–º–µ–Ω—è—Ç—å': '–Ω–∞—á–∞—Ç—å –ø—Ä–∏–º–µ–Ω—è—Ç—å',
            r'–∏–º–µ–µ—Ç–µ —Å–∏–ª—É —Å—Ç—É–ø–∏—Ç—å': '–º–æ–∂–µ—Ç–µ –Ω–∞—á–∞—Ç—å',
            r'—Å–∫–ª–æ–Ω–Ω—ã –∫ —Å–∞–º–æ—É–≤–µ—Ä–µ–Ω–∏—é': '–ø—Ä–æ—è–≤–ª—è–µ—Ç–µ –∏–∑–±—ã—Ç–æ—á–Ω—É—é —É–≤–µ—Ä–µ–Ω–Ω–æ—Å—Ç—å',
            r'–∏–º–µ–µ—Ç–µ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å': '–º–æ–∂–µ—Ç–µ',
            r'—Å—Ç–æ–∏—Ç –¥–µ–π—Å—Ç–≤–æ–≤–∞—Ç—å': '–Ω–µ–æ–±—Ö–æ–¥–∏–º–æ –¥–µ–π—Å—Ç–≤–æ–≤–∞—Ç—å'
        }
        
        for –ø–∞—Ç—Ç–µ—Ä–Ω, –∑–∞–º–µ–Ω–∞ in –∑–∞–º–µ–Ω—ã.items():
            –æ—Ç—á–µ—Ç = re.sub(–ø–∞—Ç—Ç–µ—Ä–Ω, –∑–∞–º–µ–Ω–∞, –æ—Ç—á–µ—Ç, flags=re.IGNORECASE)
        
        # –£–±–∏—Ä–∞–µ–º —É–ø–æ–º–∏–Ω–∞–Ω–∏—è –Ω–æ–º–µ—Ä–æ–≤ –≤–æ–ø—Ä–æ—Å–æ–≤
        –æ—Ç—á–µ—Ç = re.sub(r'[Qq]\d+', '', –æ—Ç—á–µ—Ç)
        –æ—Ç—á–µ—Ç = re.sub(r'–≤\.\d+', '', –æ—Ç—á–µ—Ç)
        –æ—Ç—á–µ—Ç = re.sub(r'–í–æ–ø—Ä–æ—Å\s+\d+', '', –æ—Ç—á–µ—Ç)
        
        # –£–±–∏—Ä–∞–µ–º –∞–Ω–≥–ª–∏–π—Å–∫–∏–µ —Å–ª–æ–≤–∞ (–∫—Ä–æ–º–µ —Ç–µ—Ö–Ω–∏—á–µ—Å–∫–∏—Ö —Ç–µ—Ä–º–∏–Ω–æ–≤)
        –æ—Ç—á–µ—Ç = re.sub(r'\b(?!API|AI|URL|PDF|MK|CPU|GPU\b)[a-zA-Z]+\b', '', –æ—Ç—á–µ—Ç)
        
        # –£–±–∏—Ä–∞–µ–º –¥—É–±–ª–∏—Ä–æ–≤–∞–Ω–∏–µ —Ä–∞–∑–¥–µ–ª–æ–≤
        —Å—Ç—Ä–æ–∫–∏ = –æ—Ç—á–µ—Ç.split('\n')
        —É–Ω–∏–∫–∞–ª—å–Ω—ã–µ_—Å—Ç—Ä–æ–∫–∏ = []
        –≤–∏–¥–µ–Ω–Ω—ã–µ_—Ä–∞–∑–¥–µ–ª—ã = set()
        
        for —Å—Ç—Ä–æ–∫–∞ in —Å—Ç—Ä–æ–∫–∏:
            # –ü—Ä–æ–≤–µ—Ä—è–µ–º –∑–∞–≥–æ–ª–æ–≤–∫–∏ —Ä–∞–∑–¥–µ–ª–æ–≤
            —Å—Ç—Ä–æ–∫–∞_–æ—á–∏—â–µ–Ω–Ω–∞—è = —Å—Ç—Ä–æ–∫–∞.strip()
            if re.match(r'^[‚¨õÔ∏èüìäüß†‚ö°Ô∏èüéØüõëüíªüîãüîëüöÄ]', —Å—Ç—Ä–æ–∫–∞_–æ—á–∏—â–µ–Ω–Ω–∞—è) or any(–º–∞—Ä–∫–µ—Ä in —Å—Ç—Ä–æ–∫–∞_–æ—á–∏—â–µ–Ω–Ω–∞—è for –º–∞—Ä–∫–µ—Ä in ['–£–ó–ï–õ', '–•–û–õ–û–°–¢–û–ô', '–†–ï–ê–ö–¢–û–†', '–ú–ï–¢–ê-–ú–ê–Ø–ö', '–ö–û–î –ü–ï–†–ï–ü–†–û–®–ò–í–ö–ò']):
                –∫–ª—é—á_—Ä–∞–∑–¥–µ–ª–∞ = re.sub(r'[^\w\s]', '', —Å—Ç—Ä–æ–∫–∞_–æ—á–∏—â–µ–Ω–Ω–∞—è).strip()[:30]
                if –∫–ª—é—á_—Ä–∞–∑–¥–µ–ª–∞ in –≤–∏–¥–µ–Ω–Ω—ã–µ_—Ä–∞–∑–¥–µ–ª—ã:
                    continue
                –≤–∏–¥–µ–Ω–Ω—ã–µ_—Ä–∞–∑–¥–µ–ª—ã.add(–∫–ª—é—á_—Ä–∞–∑–¥–µ–ª–∞)
            
            —É–Ω–∏–∫–∞–ª—å–Ω—ã–µ_—Å—Ç—Ä–æ–∫–∏.append(—Å—Ç—Ä–æ–∫–∞)
        
        –æ—Ç—á–µ—Ç = '\n'.join(—É–Ω–∏–∫–∞–ª—å–Ω—ã–µ_—Å—Ç—Ä–æ–∫–∏)
        
        # –£–±–∏—Ä–∞–µ–º –ª–∏—à–Ω–∏–µ –ø—Ä–æ–±–µ–ª—ã –∏ –ø—É—Å—Ç—ã–µ —Å—Ç—Ä–æ–∫–∏
        –æ—Ç—á–µ—Ç = re.sub(r'\n{3,}', '\n\n', –æ—Ç—á–µ—Ç)
        –æ—Ç—á–µ—Ç = re.sub(r'[ \t]{2,}', ' ', –æ—Ç—á–µ—Ç)
        
        # –£–±–∏—Ä–∞–µ–º markdown —Ä–∞–∑–º–µ—Ç–∫—É
        –æ—Ç—á–µ—Ç = re.sub(r'[*_`]+', '', –æ—Ç—á–µ—Ç)
        
        # –ü—Ä–æ–≤–µ—Ä—è–µ–º —Å—Ç—Ä—É–∫—Ç—É—Ä—É
        –Ω–µ–æ–±—Ö–æ–¥–∏–º—ã–µ_—Ä–∞–∑–¥–µ–ª—ã = [
            '–£–†–û–í–ï–ù–¨ –°–ò–°–¢–ï–ú–ù–û–ì–û –ó–ê–°–¢–û–Ø',
            '–£–ó–ï–õ –°–û–ü–†–û–¢–ò–í–õ–ï–ù–ò–Ø',
            '–•–û–õ–û–°–¢–û–ô –•–û–î',
            '–†–ï–ê–ö–¢–û–† –ò–î–ï–ù–¢–ò–ß–ù–û–°–¢–ò',
            '–ú–ï–¢–ê-–ú–ê–Ø–ö',
            '–ö–û–î –ü–ï–†–ï–ü–†–û–®–ò–í–ö–ò'
        ]
        
        for —Ä–∞–∑–¥–µ–ª in –Ω–µ–æ–±—Ö–æ–¥–∏–º—ã–µ_—Ä–∞–∑–¥–µ–ª—ã:
            if —Ä–∞–∑–¥–µ–ª not in –æ—Ç—á–µ—Ç.upper():
                # –ï—Å–ª–∏ –∫–∞–∫–æ–≥–æ-—Ç–æ —Ä–∞–∑–¥–µ–ª–∞ –Ω–µ—Ç, –¥–æ–±–∞–≤–ª—è–µ–º –∑–∞–≥–ª—É—à–∫—É
                if —Ä–∞–∑–¥–µ–ª == '–•–û–õ–û–°–¢–û–ô –•–û–î':
                    –æ—Ç—á–µ—Ç = –æ—Ç—á–µ—Ç.replace('–£–ó–ï–õ –°–û–ü–†–û–¢–ò–í–õ–ï–ù–ò–Ø', '–£–ó–ï–õ –°–û–ü–†–û–¢–ò–í–õ–ï–ù–ò–Ø\n\n–•–û–õ–û–°–¢–û–ô –•–û–î (–î–°–ú - –î–ï–§–û–õ–¢-–°–ò–°–¢–ï–ú–ê –ú–û–ó–ì–ê): –î–µ—Ñ–æ–ª—Ç-—Å–∏—Å—Ç–µ–º–∞ –º–æ–∑–≥–∞ (–î–°–ú) –∞–∫—Ç–∏–≤–∏—Ä–æ–≤–∞–Ω–∞. –£—Ç–∏–ª–∏–∑–∞—Ü–∏—è —ç–Ω–µ—Ä–≥–∏–∏: 80%. –≠—Ç–æ —Ä–∞–±–æ—Ç–∞ ¬´–±–∏–æ–ª–æ–≥–∏—á–µ—Å–∫–æ–≥–æ –∞–Ω—Ç–∏–≤–∏—Ä—É—Å–∞¬ª —Å–∏—Å—Ç–µ–º—ã.')
        
        return –æ—Ç—á–µ—Ç
        
    except Exception as e:
        –ª–æ–≥–≥–µ—Ä.error(f"–û—à–∏–±–∫–∞ –≤ –æ—á–∏—Å—Ç–∫–µ –æ—Ç—á–µ—Ç–∞: {e}")
        return –æ—Ç—á–µ—Ç

# --- –í–ï–ë-–°–ï–†–í–ï–† ---
async def –æ–±—Ä–∞–±–æ—Ç—á–∏–∫_–∑–¥–æ—Ä–æ–≤—å—è(–∑–∞–ø—Ä–æ—Å):
    –≤—Ä–µ–º—è_—Ä–∞–±–æ—Ç—ã = datetime.now() - –≤—Ä–µ–º—è_—Å—Ç–∞—Ä—Ç–∞
    return web.Response(text=f"–ú–µ—Ç–∞-–ù–∞–≤–∏–≥–∞—Ç–æ—Ä v2.2 | –í—Ä–µ–º—è —Ä–∞–±–æ—Ç—ã: {str(–≤—Ä–µ–º—è_—Ä–∞–±–æ—Ç—ã).split('.')[0]} | –û—à–∏–±–æ–∫: {—Å—á–µ—Ç—á–∏–∫_–æ—à–∏–±–æ–∫} | –°–±–æ–µ–≤ API: {—Å–±–æ–∏_api}")

async def –æ—Ç–ø—Ä–∞–≤–∏—Ç—å_—É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ_–æ_–∑–∞–ø—É—Å–∫–µ():
    try:
        –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è_–æ_–±–æ—Ç–µ = await –±–æ—Ç.get_me()
        —Å–æ–æ–±—â–µ–Ω–∏–µ = (
            "üöÄ META-NAVIGATOR v2.2 –ó–ê–ü–£–©–ï–ù\n\n"
            f"‚è∞ –í—Ä–µ–º—è: {datetime.now().strftime('%d.%m %H:%M:%S')}\n"
            f"ü§ñ –ë–æ—Ç: @{–∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è_–æ_–±–æ—Ç–µ.username}\n"
            f"üß† –†–µ–∂–∏–º: –°—Ç–∞—Ä—à–∏–π –ê—Ä—Ö–∏—Ç–µ–∫—Ç–æ—Ä –ò–¥–µ–Ω—Ç–∏—á–Ω–æ—Å—Ç–∏\n"
            f"üîë Cerebras API: {'‚úÖ' if –∫–ª–∏–µ–Ω—Ç else '‚ùå –î–ï–ú–û-–†–ï–ñ–ò–ú'}\n"
            f"üìä –ü–æ—Ä—Ç–∞–ª: {os.environ.get('PORT', 8080)}\n"
            f"üìé –î–æ—Å—Ç–∞–≤–∫–∞ –ø—Ä–æ—Ç–æ–∫–æ–ª–∞: –ê–ö–¢–ò–í–ù–ê (—Å –ª–æ–≤—É—à–∫–æ–π –∏–Ω—Ç–µ–ª–ª–µ–∫—Ç–∞)\n"
            f"üéØ –°–¥–≤–∏–≥ –∫ –ú–ö: 30 —Å–µ–∫ –∑–∞–¥–µ—Ä–∂–∫–∞\n"
            f"‚ö°Ô∏è –û—Ç—á–µ—Ç: –ú–æ–Ω–æ–ª–∏—Ç–Ω—ã–π –∫–æ–¥ —Å –ª–æ–∂–Ω—ã–º —Å–∏–≥–Ω–∞–ª–æ–º"
        )
        await –±–æ—Ç.send_message(chat_id=–ò–î_–ê–î–ú–ò–ù–ê, text=—Å–æ–æ–±—â–µ–Ω–∏–µ)
    except Exception as e:
        –ª–æ–≥–≥–µ—Ä.error(f"–ù–µ —É–¥–∞–ª–æ—Å—å –æ—Ç–ø—Ä–∞–≤–∏—Ç—å —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ –æ –∑–∞–ø—É—Å–∫–µ: {e}")

async def –Ω–∞—Å—Ç—Ä–æ–π–∫–∞_–≤–µ–±—Ö—É–∫–∞():
    """–ù–∞—Å—Ç—Ä–æ–π–∫–∞ –≤–µ–±—Ö—É–∫–∞ –¥–ª—è Render.com"""
    try:
        –±–∞–∑–æ–≤—ã–π_url = os.environ.get('RENDER_EXTERNAL_URL')
        if –±–∞–∑–æ–≤—ã–π_url:
            url_–≤–µ–±—Ö—É–∫–∞ = f"{–±–∞–∑–æ–≤—ã–π_url}/webhook"
            
            # –£–¥–∞–ª—è–µ–º —Å—Ç–∞—Ä—ã–π –≤–µ–±—Ö—É–∫
            await –±–æ—Ç.delete_webhook(drop_pending_updates=True)
            
            # –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º –Ω–æ–≤—ã–π –≤–µ–±—Ö—É–∫
            await –±–æ—Ç.set_webhook(
                url=url_–≤–µ–±—Ö—É–∫–∞,
                drop_pending_updates=True,
                allowed_updates=–¥–∏—Å–ø–µ—Ç—á–µ—Ä.resolve_used_update_types()
            )
            
            –ª–æ–≥–≥–µ—Ä.info(f"–í–µ–±—Ö—É–∫ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω: {url_–≤–µ–±—Ö—É–∫–∞}")
            return True
        return False
    except Exception as e:
        –ª–æ–≥–≥–µ—Ä.error(f"–û—à–∏–±–∫–∞ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –≤–µ–±—Ö—É–∫–∞: {e}")
        return False

async def –≤–µ–±—Å–µ—Ä–≤–µ—Ä_–¥–ª—è_render():
    """–ó–∞–ø—É—Å–∫–∞–µ—Ç –≤–µ–±-—Å–µ—Ä–≤–µ—Ä –¥–ª—è Render.com"""
    –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ = web.Application()
    –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ.router.add_get('/', –æ–±—Ä–∞–±–æ—Ç—á–∏–∫_–∑–¥–æ—Ä–æ–≤—å—è)
    –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ.router.add_get('/health', –æ–±—Ä–∞–±–æ—Ç—á–∏–∫_–∑–¥–æ—Ä–æ–≤—å—è)
    
    # –ù–∞—Å—Ç—Ä–∞–∏–≤–∞–µ–º –≤–µ–±—Ö—É–∫ –µ—Å–ª–∏ –µ—Å—Ç—å RENDER_EXTERNAL_URL
    if os.environ.get('RENDER_EXTERNAL_URL'):
        –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ.router.add_post('/webhook', lambda request: –¥–∏—Å–ø–µ—Ç—á–µ—Ä.feed_webhook_update(–±–æ—Ç, request))
    
    return –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ

async def –∑–∞–ø—É—Å—Ç–∏—Ç—å_–≤–µ–±—Å–µ—Ä–≤–µ—Ä():
    """–ó–∞–ø—É—Å–∫ –≤–µ–±-—Å–µ—Ä–≤–µ—Ä–∞ –¥–ª—è Render.com"""
    –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ = await –≤–µ–±—Å–µ—Ä–≤–µ—Ä_–¥–ª—è_render()
    –ø–æ—Ä—Ç = int(os.environ.get("PORT", 8080))
    
    runner = web.AppRunner(–ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ)
    await runner.setup()
    site = web.TCPSite(runner, '0.0.0.0', –ø–æ—Ä—Ç)
    await site.start()
    
    –ª–æ–≥–≥–µ—Ä.info(f"üåê –í–µ–±-—Å–µ—Ä–≤–µ—Ä –∑–∞–ø—É—â–µ–Ω –Ω–∞ –ø–æ—Ä—Ç—É {–ø–æ—Ä—Ç}")
    
    # –ó–∞–ø—É—Å–∫–∞–µ–º –≤–µ–±—Ö—É–∫ –µ—Å–ª–∏ –Ω—É–∂–Ω–æ
    if os.environ.get('RENDER_EXTERNAL_URL'):
        await –Ω–∞—Å—Ç—Ä–æ–π–∫–∞_–≤–µ–±—Ö—É–∫–∞()
        –ª–æ–≥–≥–µ—Ä.info("‚úÖ –†–µ–∂–∏–º: –í–µ–±—Ö—É–∫ (Render.com)")
    else:
        –ª–æ–≥–≥–µ—Ä.info("‚úÖ –†–µ–∂–∏–º: Polling (–ª–æ–∫–∞–ª—å–Ω–∞—è —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∞)")
    
    return runner

async def –∑–∞–ø—É—Å—Ç–∏—Ç—å_–±–æ—Ç–∞():
    """–ó–∞–ø—É—Å–∫–∞–µ—Ç –±–æ—Ç–∞ –≤ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ—Ç —Ä–µ–∂–∏–º–∞"""
    if not os.environ.get('RENDER_EXTERNAL_URL'):
        # –†–µ–∂–∏–º polling –¥–ª—è –ª–æ–∫–∞–ª—å–Ω–æ–π —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏
        await –±–æ—Ç.delete_webhook(drop_pending_updates=True)
        await –¥–∏—Å–ø–µ—Ç—á–µ—Ä.start_polling(–±–æ—Ç, skip_updates=True)

async def –≥–ª–∞–≤–Ω–∞—è():
    if not –¢–û–ö–ï–ù_–ë–û–¢–ê:
        –ª–æ–≥–≥–µ—Ä.error("‚ùå –û–®–ò–ë–ö–ê: BOT_TOKEN –Ω–µ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω!")
        raise ValueError("BOT_TOKEN –Ω–µ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω")
    
    if not –ö–õ–Æ–ß_API or not –∫–ª–∏–µ–Ω—Ç:
        –ª–æ–≥–≥–µ—Ä.warning("‚ö†Ô∏è AI_API_KEY –Ω–µ —É—Å—Ç–∞–Ω–æ–≤–µ–Ω –∏–ª–∏ Cerebras –Ω–µ–¥–æ—Å—Ç—É–ø–µ–Ω! –ë—É–¥–µ—Ç –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å—Å—è –¥–µ–º–æ-—Ä–µ–∂–∏–º.")
    
    # –ó–∞–ø—É—Å–∫–∞–µ–º —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ –æ –∑–∞–ø—É—Å–∫–µ
    try:
        await –æ—Ç–ø—Ä–∞–≤–∏—Ç—å_—É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ_–æ_–∑–∞–ø—É—Å–∫–µ()
    except Exception as e:
        –ª–æ–≥–≥–µ—Ä.error(f"–ù–µ —É–¥–∞–ª–æ—Å—å –æ—Ç–ø—Ä–∞–≤–∏—Ç—å —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ –æ –∑–∞–ø—É—Å–∫–µ: {e}")
    
    # –ó–∞–ø—É—Å–∫–∞–µ–º –≤–µ–±-—Å–µ—Ä–≤–µ—Ä
    runner = await –∑–∞–ø—É—Å—Ç–∏—Ç—å_–≤–µ–±—Å–µ—Ä–≤–µ—Ä()
    
    –ª–æ–≥–≥–µ—Ä.info(f"‚úÖ –ú–µ—Ç–∞-–ù–∞–≤–∏–≥–∞—Ç–æ—Ä v2.2 –∑–∞–ø—É—â–µ–Ω")
    –ª–æ–≥–≥–µ—Ä.info(f"ü§ñ –ë–æ—Ç: @{(await –±–æ—Ç.get_me()).username}")
    –ª–æ–≥–≥–µ—Ä.info(f"üß† –†–µ–∂–∏–º: –°—Ç–∞—Ä—à–∏–π –ê—Ä—Ö–∏—Ç–µ–∫—Ç–æ—Ä –ò–¥–µ–Ω—Ç–∏—á–Ω–æ—Å—Ç–∏")
    –ª–æ–≥–≥–µ—Ä.info(f"üîë Cerebras API: {'‚úÖ' if –∫–ª–∏–µ–Ω—Ç else '‚ùå –î–ï–ú–û-–†–ï–ñ–ò–ú'}")
    –ª–æ–≥–≥–µ—Ä.info(f"üìé –î–æ—Å—Ç–∞–≤–∫–∞ –ø—Ä–æ—Ç–æ–∫–æ–ª–∞: –ê–ö–¢–ò–í–ù–ê (—Å –ª–æ–≤—É—à–∫–æ–π –∏–Ω—Ç–µ–ª–ª–µ–∫—Ç–∞)")
    –ª–æ–≥–≥–µ—Ä.info(f"üéØ –°–¥–≤–∏–≥ –∫ –ú–ö: 30 —Å–µ–∫ –∑–∞–¥–µ—Ä–∂–∫–∞")
    –ª–æ–≥–≥–µ—Ä.info(f"‚ö°Ô∏è –û—Ç—á–µ—Ç: –ú–æ–Ω–æ–ª–∏—Ç–Ω—ã–π –∫–æ–¥ —Å –ª–æ–∂–Ω—ã–º —Å–∏–≥–Ω–∞–ª–æ–º")
    –ª–æ–≥–≥–µ—Ä.info(f"üåê –ü—Ä–æ–≤–µ—Ä–∫–∞: http://0.0.0.0:{os.environ.get('PORT', 8080)}/")
    –ª–æ–≥–≥–µ—Ä.info(f"üìù –¢–µ—Ö–Ω–∏—á–µ—Å–∫–∏–π –æ–ø—Ä–æ—Å–Ω–∏–∫: {len(–í–û–ü–†–û–°–´)} –≤–æ–ø—Ä–æ—Å–æ–≤")
    
    # –ï—Å–ª–∏ –Ω–µ –∏—Å–ø–æ–ª—å–∑—É–µ–º –≤–µ–±—Ö—É–∫, –∑–∞–ø—É—Å–∫–∞–µ–º polling
    if not os.environ.get('RENDER_EXTERNAL_URL'):
        try:
            await –∑–∞–ø—É—Å—Ç–∏—Ç—å_–±–æ—Ç–∞()
        except Exception as e:
            –ª–æ–≥–≥–µ—Ä.critical(f"–ë–æ—Ç –æ—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω: {e}")
            await –æ—Ç–ø—Ä–∞–≤–∏—Ç—å_–∞–ª–µ—Ä—Ç_–∞–¥–º–∏–Ω—É("–∫—Ä–∞—à_–±–æ—Ç–∞", f"–ë–æ—Ç –æ—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω: {str(e)}", traceback.format_exc())
            raise
    else:
        # –í —Ä–µ–∂–∏–º–µ –≤–µ–±—Ö—É–∫–∞ –ø—Ä–æ—Å—Ç–æ –¥–µ—Ä–∂–∏–º —Å–µ—Ä–≤–µ—Ä –∞–∫—Ç–∏–≤–Ω—ã–º
        –ª–æ–≥–≥–µ—Ä.info("üåê –°–µ—Ä–≤–µ—Ä –≤–µ–±—Ö—É–∫–∞ –∑–∞–ø—É—â–µ–Ω, –æ–∂–∏–¥–∞–µ–º –∑–∞–ø—Ä–æ—Å—ã –æ—Ç Telegram...")
        try:
            # –ë–µ—Å–∫–æ–Ω–µ—á–Ω—ã–π —Ü–∏–∫–ª –¥–ª—è –ø–æ–¥–¥–µ—Ä–∂–∞–Ω–∏—è —Ä–∞–±–æ—Ç—ã —Å–µ—Ä–≤–µ—Ä–∞
            while True:
                await asyncio.sleep(3600)  # –°–ø–∏–º 1 —á–∞—Å
        except (KeyboardInterrupt, SystemExit):
            –ª–æ–≥–≥–µ—Ä.info("–ë–æ—Ç –æ—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–º")
        except Exception as e:
            –ª–æ–≥–≥–µ—Ä.critical(f"–°–µ—Ä–≤–µ—Ä –æ—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω: {e}")
            await –æ—Ç–ø—Ä–∞–≤–∏—Ç—å_–∞–ª–µ—Ä—Ç_–∞–¥–º–∏–Ω—É("–∫—Ä–∞—à_—Å–µ—Ä–≤–µ—Ä–∞", f"–°–µ—Ä–≤–µ—Ä –æ—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω: {str(e)}", traceback.format_exc())
            raise
        finally:
            await runner.cleanup()

if __name__ == "__main__":
    try:
        # –î–ª—è Render.com: –∏—Å–ø–æ–ª—å–∑—É–µ–º asyncio.run —Å –æ–±—Ä–∞–±–æ—Ç–∫–æ–π –æ—à–∏–±–æ–∫
        if sys.platform == 'win32':
            asyncio.run(–≥–ª–∞–≤–Ω–∞—è())
        else:
            # –ù–∞ Linux/Unix –∏—Å–ø–æ–ª—å–∑—É–µ–º uvloop –µ—Å–ª–∏ –¥–æ—Å—Ç—É–ø–µ–Ω
            try:
                import uvloop
                uvloop.run(–≥–ª–∞–≤–Ω–∞—è())
            except ImportError:
                asyncio.run(–≥–ª–∞–≤–Ω–∞—è())
    except KeyboardInterrupt:
        –ª–æ–≥–≥–µ—Ä.info("–ë–æ—Ç –æ—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–º")
        sys.exit(0)
    except SystemExit:
        sys.exit(0)
    except Exception as e:
        –ª–æ–≥–≥–µ—Ä.critical(f"–ö—Ä–∏—Ç–∏—á–µ—Å–∫–∞—è –æ—à–∏–±–∫–∞ –ø—Ä–∏ –∑–∞–ø—É—Å–∫–µ: {e}")
        sys.exit(1)
